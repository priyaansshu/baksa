{"ast":null,"code":"import _toConsumableArray from\"/Users/priyanshumodi/Desktop/Code/React/dot/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _createForOfIteratorHelper from\"/Users/priyanshumodi/Desktop/Code/React/dot/client/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _slicedToArray from\"/Users/priyanshumodi/Desktop/Code/React/dot/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import logo from'./logo.svg';import'./App.css';import react,{useState,useEffect,useRef}from'react';import\"./style.css\";import Dot from'./Components/Dot';import Grid from'./Components/Grid';import GameOver from'./Components/GameOver';import Header from'./Components/Header';import{io}from\"socket.io-client\";import{ToastContainer,toast}from'react-toastify';import{css}from\"glamor\";import Chat from'./Components/Chat';import{useNavigate}from'react-router-dom';import{useBeforeunload}from'react-beforeunload';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var socket=io('https://baksa19.herokuapp.com/',{transports:['websocket']});export default function Game(props){var i,j;var tempBoxCount=0;var compTempPos;var compBoxFlag=false;var comp2line=false;var _useState=useState(new Map()),_useState2=_slicedToArray(_useState,2),elMap=_useState2[0],setMap=_useState2[1];var _useState3=useState(new Map()),_useState4=_slicedToArray(_useState3,2),boxMap=_useState4[0],setBoxMap=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),mapFlag=_useState6[0],setMapFlag=_useState6[1];//used to make sure the map is initialised only once\nvar _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),boxFlag=_useState8[0],setBoxFlag=_useState8[1];//used to make sure the box map is initialised only once\nvar red=\"#c5183b\";var blue=\"#3b919b\";var assignedColor=props.playerRole==1?red:blue;var _useState9=useState(red),_useState10=_slicedToArray(_useState9,2),turn=_useState10[0],setTurn=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),redScore=_useState12[0],setRedScore=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),blueScore=_useState14[0],setBlueScore=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),gameOver=_useState16[0],setGameOver=_useState16[1];var position;var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),tempId=_useState18[0],setTempId=_useState18[1];var _useState19=useState(\"\"),_useState20=_slicedToArray(_useState19,2),tempColor=_useState20[0],setTempColor=_useState20[1];var _useState21=useState(\"\"),_useState22=_slicedToArray(_useState21,2),finalRoomId=_useState22[0],setFinalRoomId=_useState22[1];var _useState23=useState([]),_useState24=_slicedToArray(_useState23,2),messageArr=_useState24[0],setMessageArr=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),showChat=_useState26[0],setShowChat=_useState26[1];var _useState27=useState(0),_useState28=_slicedToArray(_useState27,2),unreadCount=_useState28[0],setUnreadCount=_useState28[1];var _useState29=useState(0),_useState30=_slicedToArray(_useState29,2),lastSeen=_useState30[0],setLastSeen=_useState30[1];var chatRef=useRef();var gridRef=useRef();var chatButtonRef=useRef();var _useState31=useState(\"none\"),_useState32=_slicedToArray(_useState31,2),gameLeaveWinner=_useState32[0],setGameLeaveWinner=_useState32[1];var _useState33=useState(false),_useState34=_slicedToArray(_useState33,2),playerLeft=_useState34[0],setPlayerLeft=_useState34[1];var _useState35=useState([]),_useState36=_slicedToArray(_useState35,2),locationKeys=_useState36[0],setLocationKeys=_useState36[1];var history=useNavigate();var t;// variable for temporarily handling id\nvar tempTurn;// variable for temporarily handling turn\nvar tempBoxColor=\"\";useEffect(function(){var curUrl=JSON.stringify(window.location.href);if(curUrl.substring(curUrl.length-8,curUrl.length-1)==\"offline\"){props.setVsComp(true);}},[]);useEffect(function(){var tempRoomId=props.roomId+\"1\";socket.emit(\"rejoin\",{roomId:tempRoomId});},[]);useEffect(function(){socket.on(\"final-room\",function(_ref){var roomId=_ref.roomId;// console.log(roomId);\nsetFinalRoomId(roomId);});},[socket]);function updateMapWithServer(){// console.log(\"received\");\n// socket.emit(\"test\", {roomId: finalRoomId, socketId: props.socketId});\nsocket.emit(\"update\",{turn:tempTurn,roomId:finalRoomId,socketId:props.socketId,position:position,tempId:t,tempBoxColor:tempBoxColor});}useEffect(function(){// console.log(socket);\nsocket.on(\"updated\",function(data){position=data.position;tempBoxColor=data.tempBoxColor;updateLocalVariablesWithServerValues(data.tempId,data.turn);elementCheckUtilityFunction(position,data.tempId);});},[socket]);function updateLocalVariablesWithServerValues(tempId,tempColor){setTempId(tempId);setTempColor(tempColor);}(function initMap(){if(mapFlag){var tempSize=props.gridSize==4?65:225;for(i=0;i<tempSize;++i){// for(i=0; i<props.gridSize==4?65:225; ++i){\nelMap.set(i,\"unclicked\");}setMapFlag(false);}})();(function initBoxMap(){if(boxFlag){for(i=1;i<=props.gridSize;++i){// for(i=1; i<=4; ++i){\nfor(j=1;j<=props.gridSize;++j){// for(j=1; j<=4; ++j)\nboxMap.set(\"b-\"+i+\"-\"+j,\"transparent\");}}setBoxFlag(false);}})();function updateMap(position){if(elMap.get(position)!==\"clicked\"){setMap(elMap.set(position,\"clicked\"));// console.log(elMap);\n}}function elementCheckUtilityFunction(position,id){// console.log(\"here\");\nupdateMap(position);setTurnFunc();if(id.charAt(0)==\"h\"){checkVerticalBoxes(id);}else{checkHorizontalBoxes(id);}}function elementCheck(id){console.log(elMap);t=id;tempBoxColor=\"\";position=calcPosition(id);console.log(position);elementCheckUtilityFunction(position,id);tempTurn=turn;if(!props.vsComp)updateMapWithServer();}function calcPosition(id){var part1=0,part2=0,position=0;if(id.charAt(0)==\"d\"){part1=14*(parseInt(id.charAt(2))-1);part2=2*parseInt(id.charAt(4))-2;}else if(id.charAt(0)==\"h\"){part1=14*(parseInt(id.charAt(2))-1);part2=2*parseInt(id.charAt(4))-1;}else{part1=14*parseInt(id.charAt(2))-5;part2=parseInt(id.charAt(4));}position=part1+part2;// console.log(position);\nreturn position;}function setTurnFunc(){setTurn(function(turn){return turn===red?blue:red;});// console.log(\"In the setTurn function: \"+turn);\n}function stayTurn(boxColor){setTurn(boxColor);}function checkVerticalBoxes(id){// console.log(id);\nvar id1,id2,id3,id4,id5,id6;var pos1,pos2,pos3,pos4,pos5,pos6;var n=parseInt(id.charAt(2)),m=parseInt(id.charAt(4));id1=\"h-\"+(n-1)+\"-\"+m;id2=\"h-\"+(n+1)+\"-\"+m;id3=\"v-\"+(n-1)+\"-\"+m;id4=\"v-\"+(n-1)+\"-\"+(m+1);id5=\"v-\"+n+\"-\"+m;id6=\"v-\"+n+\"-\"+(m+1);pos1=calcPosition(id1);pos2=calcPosition(id2);pos3=calcPosition(id3);pos4=calcPosition(id4);pos5=calcPosition(id5);pos6=calcPosition(id6);if(tempBoxColor==\"\"){var boxColor=turn;}else{var boxColor=tempBoxColor;}if(elMap.get(pos1)==\"clicked\"&&elMap.get(pos2)==\"clicked\"&&elMap.get(pos3)==\"clicked\"&&elMap.get(pos4)==\"clicked\"&&elMap.get(pos5)==\"clicked\"&&elMap.get(pos6)==\"clicked\"){console.log(\"upper and lower boxes filled\");setBoxMap(boxMap.set(\"b-\"+(n-1)+\"-\"+m,boxColor));setBoxMap(boxMap.set(\"b-\"+n+\"-\"+m,boxColor));stayTurn(boxColor);updateScore(\"b-\"+(n-1)+\"-\"+m);updateScore(\"b-\"+n+\"-\"+m);updateTotal();}else if(elMap.get(pos1)==\"clicked\"&&elMap.get(pos3)==\"clicked\"&&elMap.get(pos4)==\"clicked\"){console.log(\"upper box filled\");setBoxMap(boxMap.set(\"b-\"+(n-1)+\"-\"+m,boxColor));stayTurn(boxColor);updateScore(\"b-\"+(n-1)+\"-\"+m);updateTotal();}else if(elMap.get(pos2)==\"clicked\"&&elMap.get(pos5)==\"clicked\"&&elMap.get(pos6)==\"clicked\"){console.log(\"lower box filled\");setBoxMap(boxMap.set(\"b-\"+n+\"-\"+m,boxColor));stayTurn(boxColor);updateScore(\"b-\"+n+\"-\"+m);updateTotal();}// console.log(boxMap);\ntempBoxColor=boxColor;}function checkHorizontalBoxes(id){// console.log(id);\nvar id1,id2,id3,id4,id5,id6;var pos1,pos2,pos3,pos4,pos5,pos6;var n=parseInt(id.charAt(2)),m=parseInt(id.charAt(4));id1=\"h-\"+n+\"-\"+(m-1);id2=\"v-\"+n+\"-\"+(m-1);id3=\"h-\"+(n+1)+\"-\"+(m-1);id4=\"h-\"+n+\"-\"+m;id5=\"v-\"+n+\"-\"+(m+1);id6=\"h-\"+(n+1)+\"-\"+m;pos1=calcPosition(id1);pos2=calcPosition(id2);pos3=calcPosition(id3);pos4=calcPosition(id4);pos5=calcPosition(id5);pos6=calcPosition(id6);if(tempBoxColor==\"\"){var boxColor=turn;}else{var boxColor=tempBoxColor;}if(elMap.get(pos1)==\"clicked\"&&elMap.get(pos2)==\"clicked\"&&elMap.get(pos3)==\"clicked\"&&elMap.get(pos4)==\"clicked\"&&elMap.get(pos5)==\"clicked\"&&elMap.get(pos6)==\"clicked\"){console.log(\"left and right boxes filled\");setBoxMap(boxMap.set(\"b-\"+n+\"-\"+(m-1),boxColor));setBoxMap(boxMap.set(\"b-\"+n+\"-\"+m,boxColor));stayTurn(boxColor);updateScore(\"b-\"+n+\"-\"+(m-1));updateScore(\"b-\"+n+\"-\"+m);updateTotal();}else if(elMap.get(pos1)==\"clicked\"&&elMap.get(pos2)==\"clicked\"&&elMap.get(pos3)==\"clicked\"){console.log(\"left box filled\");setBoxMap(boxMap.set(\"b-\"+n+\"-\"+(m-1),boxColor));stayTurn(boxColor);updateScore(\"b-\"+n+\"-\"+(m-1));updateTotal();}else if(elMap.get(pos4)==\"clicked\"&&elMap.get(pos5)==\"clicked\"&&elMap.get(pos6)==\"clicked\"){console.log(\"right box filled\");setBoxMap(boxMap.set(\"b-\"+n+\"-\"+m,boxColor));stayTurn(boxColor);updateScore(\"b-\"+n+\"-\"+m);updateTotal();}// console.log(boxMap);\ntempBoxColor=boxColor;}function updateScore(tempBoxId){if(boxMap.get(tempBoxId)==red){setRedScore(function(redScore){return redScore+1;});}else if(boxMap.get(tempBoxId)==blue){setBlueScore(function(blueScore){return blueScore+1;});}}function updateTotal(){tempBoxCount=0;var _iterator=_createForOfIteratorHelper(boxMap.entries()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),key=_step$value[0],value=_step$value[1];if(value!=\"transparent\"){// console.log(key+\": \"+value);\ntempBoxCount++;}}}catch(err){_iterator.e(err);}finally{_iterator.f();}console.log(\"tempBoxCount: \"+tempBoxCount);if(props.gridSize==4){if(tempBoxCount==16){setGameOver(true);}}else if(props.gridSize==8){if(tempBoxCount==64){setGameOver(true);}}// console.log(\"totalScore: \"+(redScore+blueScore));\n// if(props.gridSize == 4 && redScore+blueScore == 15){\n//   setGameOver(true);\n// }\n// else if(props.gridSize == 8 && redScore+blueScore == 63){\n//   setGameOver(true);\n// }\n}// function compCheckVerticalBoxes(id, elRef){\n//   // console.log(id);\n//   var id1, id2, id3, id4, id5, id6;\n//   var pos1, pos2, pos3, pos4, pos5, pos6;\n//   var n = parseInt(id.charAt(2)), m = parseInt(id.charAt(4));\n//   id1=\"h-\"+(n-1)+\"-\"+m;\n//   id2=\"h-\"+(n+1)+\"-\"+m;\n//   id3=\"v-\"+(n-1)+\"-\"+m;\n//   id4=\"v-\"+(n-1)+\"-\"+(m+1);\n//   id5=\"v-\"+(n)+\"-\"+m;\n//   id6=\"v-\"+(n)+\"-\"+(m+1);\n//   pos1=calcPosition(id1);\n//   pos2=calcPosition(id2);\n//   pos3=calcPosition(id3);\n//   pos4=calcPosition(id4);\n//   pos5=calcPosition(id5);\n//   pos6=calcPosition(id6);\n//   var boxColor = turn==blue?blue:red;\n//   if(elMap.get(pos1)==\"clicked\" && elMap.get(pos2)== \"clicked\" && elMap.get(pos3)==\"clicked\" && elMap.get(pos4)== \"clicked\" && elMap.get(pos5)==\"clicked\" && elMap.get(pos6)== \"clicked\"){\n//     compBoxFlag = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//     setBoxMap(boxMap.set((\"b-\"+(n-1)+\"-\"+m), boxColor));\n//     setBoxMap(boxMap.set((\"b-\"+n+\"-\"+m), boxColor));\n//     stayTurn();\n//     updateScore((\"b-\"+(n-1)+\"-\"+m));\n//     updateScore((\"b-\"+n+\"-\"+m));\n//     updateTotal();\n//   }\n//   else if(elMap.get(pos1)==\"clicked\" && elMap.get(pos3)== \"clicked\" && elMap.get(pos4)==\"clicked\"){\n//     compBoxFlag = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//     setBoxMap(boxMap.set((\"b-\"+(n-1)+\"-\"+m), boxColor));\n//     stayTurn();\n//     updateScore((\"b-\"+(n-1)+\"-\"+m));\n//     updateTotal();\n//   }\n//   else if(elMap.get(pos2)== \"clicked\" && elMap.get(pos5)==\"clicked\" && elMap.get(pos6)== \"clicked\"){\n//     compBoxFlag = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//     setBoxMap(boxMap.set((\"b-\"+n+\"-\"+m), boxColor));\n//     stayTurn();\n//     updateScore((\"b-\"+n+\"-\"+m));\n//     updateTotal();\n//   }\n// }\n// function compCheckHorizontalBoxes(id, elRef){\n//   // console.log(id);\n//   var id1, id2, id3, id4, id5, id6;\n//   var pos1, pos2, pos3, pos4, pos5, pos6;\n//   var n = parseInt(id.charAt(2)), m = parseInt(id.charAt(4));\n//   id1=\"h-\"+(n)+\"-\"+(m-1);\n//   id2=\"v-\"+(n)+\"-\"+(m-1);\n//   id3=\"h-\"+(n+1)+\"-\"+(m-1);\n//   id4=\"h-\"+(n)+\"-\"+(m);\n//   id5=\"v-\"+(n)+\"-\"+(m+1);\n//   id6=\"h-\"+(n+1)+\"-\"+(m);\n//   pos1=calcPosition(id1);\n//   pos2=calcPosition(id2);\n//   pos3=calcPosition(id3);\n//   pos4=calcPosition(id4);\n//   pos5=calcPosition(id5);\n//   pos6=calcPosition(id6);\n//   var boxColor = turn==blue?blue:red;\n//   if(elMap.get(pos1)==\"clicked\" && elMap.get(pos2)== \"clicked\" && elMap.get(pos3)==\"clicked\" && elMap.get(pos4)== \"clicked\" && elMap.get(pos5)==\"clicked\" && elMap.get(pos6)== \"clicked\"){\n//     compBoxFlag = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//     setBoxMap(boxMap.set(\"b-\"+n+\"-\"+(m-1), boxColor));\n//     setBoxMap(boxMap.set((\"b-\"+n+\"-\"+m), boxColor));\n//     stayTurn();\n//     updateScore((\"b-\"+n+\"-\"+(m-1)));\n//     updateScore((\"b-\"+n+\"-\"+m));\n//     updateTotal();\n//   }\n//   else if(elMap.get(pos1)==\"clicked\" && elMap.get(pos2)== \"clicked\" && elMap.get(pos3)==\"clicked\"){\n//     compBoxFlag = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//     setBoxMap(boxMap.set(\"b-\"+n+\"-\"+(m-1), boxColor));\n//     stayTurn();\n//     updateScore((\"b-\"+n+\"-\"+(m-1)));\n//     updateTotal();\n//   }\n//   else if(elMap.get(pos4)== \"clicked\" && elMap.get(pos5)==\"clicked\" && elMap.get(pos6)== \"clicked\"){\n//     compBoxFlag = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//     setBoxMap(boxMap.set((\"b-\"+n+\"-\"+m), boxColor));\n//     stayTurn();\n//     updateScore((\"b-\"+n+\"-\"+m));\n//     updateTotal();\n//   }\n// }\n// function compCheck1lineHorizontal(id, elRef){\n//   console.log(id);\n//   var id1, id2, id3, id4, id5, id6;\n//   var pos1, pos2, pos3, pos4, pos5, pos6;\n//   var n = parseInt(id.charAt(2)), m = parseInt(id.charAt(4));\n//   id1=\"h-\"+(n-1)+\"-\"+m;\n//   id2=\"h-\"+(n+1)+\"-\"+m;\n//   id3=\"v-\"+(n-1)+\"-\"+m;\n//   id4=\"v-\"+(n-1)+\"-\"+(m+1);\n//   id5=\"v-\"+(n)+\"-\"+m;\n//   id6=\"v-\"+(n)+\"-\"+(m+1);\n//   pos1=calcPosition(id1);\n//   pos2=calcPosition(id2);\n//   pos3=calcPosition(id3);\n//   pos4=calcPosition(id4);\n//   pos5=calcPosition(id5);\n//   pos6=calcPosition(id6);\n//   if(elMap.get(pos1)==\"clicked\" && elMap.get(pos3)== \"clicked\"){\n//     comp2line = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//   }\n//   else if(elMap.get(pos1)==\"clicked\" && elMap.get(pos4)== \"clicked\"){\n//     comp2line = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//   }\n//   if(elMap.get(pos3)==\"clicked\" && elMap.get(pos4)== \"clicked\"){\n//     comp2line = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//   }\n//   else if(elMap.get(pos2)== \"clicked\" && elMap.get(pos5)==\"clicked\"){\n//     comp2line = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//   }\n//   else if(elMap.get(pos2)== \"clicked\" && elMap.get(pos6)==\"clicked\"){\n//     comp2line = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//   }\n//   else if(elMap.get(pos5)== \"clicked\" && elMap.get(pos6)==\"clicked\"){\n//     comp2line = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//   }\n// }\n// function compCheck1lineVertical(id, elRef){\n//   console.log(id);\n//   var id1, id2, id3, id4, id5, id6;\n//   var pos1, pos2, pos3, pos4, pos5, pos6;\n//   var n = parseInt(id.charAt(2)), m = parseInt(id.charAt(4));\n//   id1=\"h-\"+(n)+\"-\"+(m-1);\n//   id2=\"v-\"+(n)+\"-\"+(m-1);\n//   id3=\"h-\"+(n+1)+\"-\"+(m-1);\n//   id4=\"h-\"+(n)+\"-\"+(m);\n//   id5=\"v-\"+(n)+\"-\"+(m+1);\n//   id6=\"h-\"+(n+1)+\"-\"+(m);\n//   pos1=calcPosition(id1);\n//   pos2=calcPosition(id2);\n//   pos3=calcPosition(id3);\n//   pos4=calcPosition(id4);\n//   pos5=calcPosition(id5);\n//   pos6=calcPosition(id6);\n//   if(elMap.get(pos1)==\"clicked\" && elMap.get(pos2)== \"clicked\"){\n//     comp2line = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//   }\n//   else if(elMap.get(pos1)==\"clicked\" && elMap.get(pos3)== \"clicked\"){\n//     comp2line = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//   }\n//   if(elMap.get(pos2)==\"clicked\" && elMap.get(pos3)== \"clicked\"){\n//     comp2line = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//   }\n//   else if(elMap.get(pos4)== \"clicked\" && elMap.get(pos5)==\"clicked\"){\n//     comp2line = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//   }\n//   else if(elMap.get(pos4)== \"clicked\" && elMap.get(pos6)==\"clicked\"){\n//     comp2line = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//   }\n//   else if(elMap.get(pos5)== \"clicked\" && elMap.get(pos6)==\"clicked\"){\n//     comp2line = true;\n//     compTempPos = calcPosition(id);\n//     elMap.set(compTempPos, \"clicked\");\n//     elRef.current.style.backgroundColor = blue;\n//   }\n// }\n// function compFunc(elRef){\n//   console.log(\"computer's turn\");\n//   console.log(elMap);\n//   compBoxFlag = false;\n//   var comp1line = false;\n//   var comp0line = false;\n//   if(compBoxFlag == false){\n//     // check box completion\n//     console.log(\"check box completion\")\n//     for(var i=1; i<=props.gridSize+1; ++i){\n//       for(var j=1; j<=props.gridSize; ++j){\n//         var compTempId1 = \"h-\"+[i]+\"-\"+[j];\n//         var compTempId2 = \"v-\"+[j]+\"-\"+[i];\n//         while(compBoxFlag == false){\n//           if(elMap.get(calcPosition(compTempId1))!=\"clicked\"){\n//             compCheckVerticalBoxes(compTempId1, elRef);\n//           }\n//           if(elMap.get(calcPosition(compTempId2))!=\"clicked\"){\n//             compCheckHorizontalBoxes(compTempId2, elRef);\n//           }\n//         }\n//       }\n//     }\n//   }\n//   if(compBoxFlag == false && comp1line == false && comp0line == false){\n//     // check 0 line clicked\n//     console.log(\"check 0 line clicked\")\n//     for(var i=1; i<=props.gridSize+1; ++i){\n//       for(var j=1; j<=props.gridSize; ++j){\n//         var compTempId1 = \"h-\"+[i]+\"-\"+[j];\n//         var compTempId2 = \"v-\"+[j]+\"-\"+[i];\n//         while(comp0line == false){\n//           if(elMap.get(calcPosition(compTempId1))!=\"clicked\"){\n//             comp0line = true;\n//             compTempPos = calcPosition(compTempId1);\n//             elMap.set(compTempPos, \"clicked\");\n//             elRef.current.style.backgroundColor = blue;\n//           }\n//           if(elMap.get(calcPosition(compTempId2))!=\"clicked\"){\n//             comp0line = true;\n//             compTempPos = calcPosition(compTempId2);\n//             elMap.set(compTempPos, \"clicked\");\n//             elRef.current.style.backgroundColor = blue;\n//           }\n//         }  \n//       }\n//     }\n//   }\n// }\nvar playerColorToastId=useRef(null);useEffect(function(){var curUrl=JSON.stringify(window.location.href);var tempVsComp;if(curUrl.substring(curUrl.length-8,curUrl.length-1)==\"offline\"){tempVsComp=true;}if(!tempVsComp&&!gameOver){var playerColor=assignedColor==\"#c5183b\"?\"Red\":\"Blue\";playerColorToastId.current=toast(\"You are \"+playerColor,{position:\"top-right\",autoClose:5000,hideProgressBar:true,closeOnClick:true,pauseOnHover:false,draggable:true,progress:undefined});}},[gameOver,props.vsComp]);function notTurnFunc(){toast(\"It's not your turn\",{position:\"top-right\",autoClose:1000,hideProgressBar:true,closeOnClick:true,pauseOnHover:false,draggable:true,progress:undefined});}function sendMessage(tempMessage,playerRole){if(tempMessage==\"\"){return;}socket.emit(\"send-message\",{roomId:finalRoomId,tempMessage:tempMessage,playerRole:playerRole});}socket.off(\"receive-message\");socket.on(\"receive-message\",function(tempMessage,playerRole){console.log(\"message received\");var tempMessageArr=_toConsumableArray(messageArr);tempMessageArr.push({sender:playerRole,message:tempMessage});console.log(tempMessageArr);setMessageArr(tempMessageArr);});useEffect(function(){// if(playerColorToastId.current!=null && showChat){\n//   toast.dismiss(playerColorToastId.current);\n// }\nif(showChat){setLastSeen(messageArr.length);setUnreadCount(0);}var tempUnreadCount=messageArr.length-lastSeen;setUnreadCount(tempUnreadCount);},[showChat]);useEffect(function(){if(showChat){setUnreadCount(0);setLastSeen(messageArr.length);}else{var tempUnreadCount=messageArr.length-lastSeen;setUnreadCount(tempUnreadCount);}},[messageArr.length]);useEffect(function(){if(showChat){var handleClickOutside=function handleClickOutside(event){if(chatRef.current&&!chatRef.current.contains(event.target)&&gridRef.current&&!gridRef.current.contains(event.target)&&chatButtonRef.current&&!chatButtonRef.current.contains(event.target)){setShowChat(false);}};document.addEventListener(\"mousedown\",handleClickOutside);return function(){document.removeEventListener(\"mousedown\",handleClickOutside);};}},[showChat]);// socket.off(\"game-left\");\nuseEffect(function(){if(!props.vsComp){!gameOver&&socket.on(\"game-left\",function(_ref2){var winner=_ref2.winner;console.log(\"The other player left the game\");setPlayerLeft(true);setGameOver(true);setGameLeaveWinner(winner);});}},[socket]);useEffect(function(){if(!props.vsComp){var tempRoomId=finalRoomId;if(!playerLeft){var intervalId=setInterval(function(){socket.emit(\"game-leave-check\",{playerRole:props.playerRole,roomId:tempRoomId});},2000);}}},[finalRoomId]);window.addEventListener('popstate',function(event){if(event.state){window.location.reload();}},false);useEffect(function(){window.history.pushState({name:\"browserBack\"},\"on browser back click\",window.location.href);window.history.pushState({name:\"browserBack\"},\"on browser back click\",window.location.href);},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{gridSize:props.gridSize,gameOver:gameOver,fromMidGame:true,vsComp:props.vsComp}),/*#__PURE__*/_jsxs(\"div\",{className:\"center-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:!gameOver?\"show-grid\":\"hide-grid\",ref:gridRef,children:/*#__PURE__*/_jsx(Grid,{gridSize:props.gridSize,func:elementCheck,turn:turn,map:elMap,boxMap:boxMap,vsComp:props.vsComp,tempColor:tempColor,tempId:tempId,assignedColor:assignedColor,notTurnFunc:notTurnFunc})}),/*#__PURE__*/_jsx(\"div\",{className:!gameOver?\"hide-game-over\":\"show-game-over\",children:/*#__PURE__*/_jsx(GameOver,{gameLeaveWinner:gameLeaveWinner,redScore:redScore,blueScore:blueScore,gridSize:props.gridSize,boxMap:boxMap,vsComp:props.vsComp,gameOver:gameOver})}),/*#__PURE__*/_jsxs(\"div\",{className:!gameOver?\"score-container\":\"hide-score-container\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"score\",id:turn==red?\"turn-score-red\":\"score-red\",children:[\"Red: \",redScore]}),/*#__PURE__*/_jsxs(\"h2\",{className:\"score\",id:turn==blue?\"turn-score-blue\":\"score-blue\",children:[\"Blue: \",blueScore]})]})]}),!props.vsComp&&/*#__PURE__*/_jsx(\"div\",{className:assignedColor==red?\"chat-button-container-red\":\"chat-button-container-blue\",children:/*#__PURE__*/_jsx(\"div\",{ref:chatButtonRef,className:\"chat-button\",onClick:function onClick(){setShowChat(!showChat);},children:/*#__PURE__*/_jsx(\"div\",{className:\"unread-count-container\",style:{visibility:unreadCount==0?\"hidden\":\"visible\"},children:unreadCount})})}),!props.vsComp&&/*#__PURE__*/_jsx(\"div\",{ref:chatRef,children:/*#__PURE__*/_jsx(Chat,{sendMessage:sendMessage,messageArr:messageArr,chatColor:assignedColor,roomId:finalRoomId,playerRole:props.playerRole,showChat:showChat})}),/*#__PURE__*/_jsx(ToastContainer,{})]});}","map":{"version":3,"sources":["/Users/priyanshumodi/Desktop/Code/React/dot/client/src/Game.js"],"names":["logo","react","useState","useEffect","useRef","Dot","Grid","GameOver","Header","io","ToastContainer","toast","css","Chat","useNavigate","useBeforeunload","socket","transports","Game","props","i","j","tempBoxCount","compTempPos","compBoxFlag","comp2line","Map","elMap","setMap","boxMap","setBoxMap","mapFlag","setMapFlag","boxFlag","setBoxFlag","red","blue","assignedColor","playerRole","turn","setTurn","redScore","setRedScore","blueScore","setBlueScore","gameOver","setGameOver","position","tempId","setTempId","tempColor","setTempColor","finalRoomId","setFinalRoomId","messageArr","setMessageArr","showChat","setShowChat","unreadCount","setUnreadCount","lastSeen","setLastSeen","chatRef","gridRef","chatButtonRef","gameLeaveWinner","setGameLeaveWinner","playerLeft","setPlayerLeft","locationKeys","setLocationKeys","history","t","tempTurn","tempBoxColor","curUrl","JSON","stringify","window","location","href","substring","length","setVsComp","tempRoomId","roomId","emit","on","updateMapWithServer","socketId","data","updateLocalVariablesWithServerValues","elementCheckUtilityFunction","initMap","tempSize","gridSize","set","initBoxMap","updateMap","get","id","setTurnFunc","charAt","checkVerticalBoxes","checkHorizontalBoxes","elementCheck","console","log","calcPosition","vsComp","part1","part2","parseInt","stayTurn","boxColor","id1","id2","id3","id4","id5","id6","pos1","pos2","pos3","pos4","pos5","pos6","n","m","updateScore","updateTotal","tempBoxId","entries","key","value","playerColorToastId","tempVsComp","playerColor","current","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","notTurnFunc","sendMessage","tempMessage","off","tempMessageArr","push","sender","message","tempUnreadCount","handleClickOutside","event","contains","target","document","addEventListener","removeEventListener","winner","intervalId","setInterval","state","reload","pushState","name","visibility"],"mappings":"wbAAA,MAAOA,CAAAA,IAAP,KAAiB,YAAjB,CACA,MAAO,WAAP,CACA,MAAOC,CAAAA,KAAP,EAAeC,QAAf,CAAyBC,SAAzB,CAAoCC,MAApC,KAAiD,OAAjD,CACA,MAAO,aAAP,CACA,MAAOC,CAAAA,GAAP,KAAgB,kBAAhB,CACA,MAAOC,CAAAA,IAAP,KAAiB,mBAAjB,CACA,MAAOC,CAAAA,QAAP,KAAqB,uBAArB,CACA,MAAOC,CAAAA,MAAP,KAAmB,qBAAnB,CACA,OAAQC,EAAR,KAAiB,kBAAjB,CACA,OAASC,cAAT,CAAyBC,KAAzB,KAAsC,gBAAtC,CACA,OAASC,GAAT,KAAoB,QAApB,CACA,MAAOC,CAAAA,IAAP,KAAiB,mBAAjB,CACA,OAASC,WAAT,KAA4B,kBAA5B,CACA,OAASC,eAAT,KAAgC,oBAAhC,C,6IAEA,GAAMC,CAAAA,MAAM,CAAGP,EAAE,CAAC,gCAAD,CAAmC,CAAEQ,UAAU,CAAG,CAAC,WAAD,CAAf,CAAnC,CAAjB,CAEA,cAAe,SAASC,CAAAA,IAAT,CAAcC,KAAd,CAAqB,CAClC,GAAIC,CAAAA,CAAJ,CAAOC,CAAP,CACA,GAAIC,CAAAA,YAAY,CAAG,CAAnB,CACA,GAAIC,CAAAA,WAAJ,CACA,GAAIC,CAAAA,WAAW,CAAG,KAAlB,CACA,GAAIC,CAAAA,SAAS,CAAG,KAAhB,CACA,cAAwBvB,QAAQ,CAAC,GAAIwB,CAAAA,GAAJ,EAAD,CAAhC,wCAAOC,KAAP,eAAcC,MAAd,eACA,eAA4B1B,QAAQ,CAAC,GAAIwB,CAAAA,GAAJ,EAAD,CAApC,yCAAOG,MAAP,eAAeC,SAAf,eAEA,eAA8B5B,QAAQ,CAAC,IAAD,CAAtC,yCAAO6B,OAAP,eAAgBC,UAAhB,eAA8C;AAC9C,eAA8B9B,QAAQ,CAAC,IAAD,CAAtC,yCAAO+B,OAAP,eAAgBC,UAAhB,eAA8C;AAE9C,GAAIC,CAAAA,GAAG,CAAC,SAAR,CACA,GAAIC,CAAAA,IAAI,CAAC,SAAT,CACA,GAAMC,CAAAA,aAAa,CAAGlB,KAAK,CAACmB,UAAN,EAAkB,CAAlB,CAAoBH,GAApB,CAAwBC,IAA9C,CAEA,eAAwBlC,QAAQ,CAACiC,GAAD,CAAhC,0CAAOI,IAAP,gBAAaC,OAAb,gBACA,gBAAgCtC,QAAQ,CAAC,CAAD,CAAxC,2CAAOuC,QAAP,gBAAiBC,WAAjB,gBACA,gBAAkCxC,QAAQ,CAAC,CAAD,CAA1C,2CAAOyC,SAAP,gBAAkBC,YAAlB,gBAEA,gBAAgC1C,QAAQ,CAAC,KAAD,CAAxC,2CAAO2C,QAAP,gBAAiBC,WAAjB,gBACA,GAAIC,CAAAA,QAAJ,CACA,gBAA4B7C,QAAQ,CAAC,EAAD,CAApC,2CAAO8C,MAAP,gBAAeC,SAAf,gBACA,gBAAkC/C,QAAQ,CAAC,EAAD,CAA1C,2CAAOgD,SAAP,gBAAkBC,YAAlB,gBAEA,gBAAsCjD,QAAQ,CAAC,EAAD,CAA9C,2CAAOkD,WAAP,gBAAoBC,cAApB,gBAEA,gBAAoCnD,QAAQ,CAAC,EAAD,CAA5C,2CAAOoD,UAAP,gBAAmBC,aAAnB,gBACA,gBAAgCrD,QAAQ,CAAC,KAAD,CAAxC,2CAAOsD,QAAP,gBAAiBC,WAAjB,gBACA,gBAAsCvD,QAAQ,CAAC,CAAD,CAA9C,2CAAOwD,WAAP,gBAAoBC,cAApB,gBACA,gBAAgCzD,QAAQ,CAAC,CAAD,CAAxC,2CAAO0D,QAAP,gBAAiBC,WAAjB,gBAEA,GAAMC,CAAAA,OAAO,CAAG1D,MAAM,EAAtB,CACA,GAAM2D,CAAAA,OAAO,CAAG3D,MAAM,EAAtB,CACA,GAAM4D,CAAAA,aAAa,CAAG5D,MAAM,EAA5B,CAEA,gBAA8CF,QAAQ,CAAC,MAAD,CAAtD,2CAAO+D,eAAP,gBAAwBC,kBAAxB,gBACA,gBAAoChE,QAAQ,CAAC,KAAD,CAA5C,2CAAOiE,UAAP,gBAAmBC,aAAnB,gBACA,gBAA0ClE,QAAQ,CAAC,EAAD,CAAlD,2CAAQmE,YAAR,gBAAsBC,eAAtB,gBACA,GAAMC,CAAAA,OAAO,CAAGzD,WAAW,EAA3B,CAEA,GAAI0D,CAAAA,CAAJ,CAAO;AACP,GAAIC,CAAAA,QAAJ,CAAc;AACd,GAAIC,CAAAA,YAAY,CAAC,EAAjB,CAGAvE,SAAS,CAAC,UAAI,CACZ,GAAIwE,CAAAA,MAAM,CAAGC,IAAI,CAACC,SAAL,CAAeC,MAAM,CAACC,QAAP,CAAgBC,IAA/B,CAAb,CACA,GAAGL,MAAM,CAACM,SAAP,CAAiBN,MAAM,CAACO,MAAP,CAAc,CAA/B,CAAkCP,MAAM,CAACO,MAAP,CAAc,CAAhD,GAAoD,SAAvD,CAAiE,CAC/D/D,KAAK,CAACgE,SAAN,CAAgB,IAAhB,EACD,CACF,CALQ,CAKN,EALM,CAAT,CAOAhF,SAAS,CAAC,UAAI,CACZ,GAAIiF,CAAAA,UAAU,CAAGjE,KAAK,CAACkE,MAAN,CAAa,GAA9B,CACArE,MAAM,CAACsE,IAAP,CAAY,QAAZ,CAAsB,CAACD,MAAM,CAAED,UAAT,CAAtB,EACD,CAHQ,CAGN,EAHM,CAAT,CAKAjF,SAAS,CAAC,UAAI,CACZa,MAAM,CAACuE,EAAP,CAAU,YAAV,CAAwB,cAAY,IAAVF,CAAAA,MAAU,MAAVA,MAAU,CAClC;AACAhC,cAAc,CAACgC,MAAD,CAAd,CACD,CAHD,EAID,CALQ,CAKN,CAACrE,MAAD,CALM,CAAT,CAOA,QAASwE,CAAAA,mBAAT,EAA8B,CAC5B;AACA;AACAxE,MAAM,CAACsE,IAAP,CAAY,QAAZ,CAAsB,CAAC/C,IAAI,CAAEkC,QAAP,CAAiBY,MAAM,CAAEjC,WAAzB,CAAsCqC,QAAQ,CAAEtE,KAAK,CAACsE,QAAtD,CAAgE1C,QAAQ,CAAEA,QAA1E,CAAoFC,MAAM,CAAEwB,CAA5F,CAA+FE,YAAY,CAAEA,YAA7G,CAAtB,EACD,CAEDvE,SAAS,CAAC,UAAI,CACZ;AACAa,MAAM,CAACuE,EAAP,CAAU,SAAV,CAAqB,SAACG,IAAD,CAAQ,CAC3B3C,QAAQ,CAAG2C,IAAI,CAAC3C,QAAhB,CACA2B,YAAY,CAAGgB,IAAI,CAAChB,YAApB,CACAiB,oCAAoC,CAACD,IAAI,CAAC1C,MAAN,CAAc0C,IAAI,CAACnD,IAAnB,CAApC,CACAqD,2BAA2B,CAAC7C,QAAD,CAAW2C,IAAI,CAAC1C,MAAhB,CAA3B,CACD,CALD,EAMD,CARQ,CAQN,CAAChC,MAAD,CARM,CAAT,CAUA,QAAS2E,CAAAA,oCAAT,CAA8C3C,MAA9C,CAAsDE,SAAtD,CAAgE,CAC9DD,SAAS,CAACD,MAAD,CAAT,CACAG,YAAY,CAACD,SAAD,CAAZ,CACD,CAED,CAAC,QAAS2C,CAAAA,OAAT,EAAkB,CACjB,GAAG9D,OAAH,CAAW,CACT,GAAI+D,CAAAA,QAAQ,CAAG3E,KAAK,CAAC4E,QAAN,EAAgB,CAAhB,CAAkB,EAAlB,CAAqB,GAApC,CACA,IAAI3E,CAAC,CAAC,CAAN,CAASA,CAAC,CAAC0E,QAAX,CAAqB,EAAE1E,CAAvB,CAAyB,CACzB;AACEO,KAAK,CAACqE,GAAN,CAAU5E,CAAV,CAAa,WAAb,EACD,CACDY,UAAU,CAAC,KAAD,CAAV,CACD,CACF,CATD,IAWA,CAAC,QAASiE,CAAAA,UAAT,EAAqB,CACpB,GAAGhE,OAAH,CAAW,CACT,IAAIb,CAAC,CAAC,CAAN,CAASA,CAAC,EAAED,KAAK,CAAC4E,QAAlB,CAA4B,EAAE3E,CAA9B,CAAgC,CAChC;AACE,IAAIC,CAAC,CAAC,CAAN,CAASA,CAAC,EAAEF,KAAK,CAAC4E,QAAlB,CAA4B,EAAE1E,CAA9B,EACA;AACEQ,MAAM,CAACmE,GAAP,CAAW,KAAK5E,CAAL,CAAO,GAAP,CAAWC,CAAtB,CAAyB,aAAzB,EAFF,CAGD,CACDa,UAAU,CAAC,KAAD,CAAV,CACD,CACF,CAVD,IAYA,QAASgE,CAAAA,SAAT,CAAmBnD,QAAnB,CAA4B,CAC1B,GAAGpB,KAAK,CAACwE,GAAN,CAAUpD,QAAV,IAAsB,SAAzB,CAAmC,CACjCnB,MAAM,CAACD,KAAK,CAACqE,GAAN,CAAUjD,QAAV,CAAoB,SAApB,CAAD,CAAN,CACA;AACD,CACF,CAED,QAAS6C,CAAAA,2BAAT,CAAqC7C,QAArC,CAA+CqD,EAA/C,CAAkD,CAChD;AACAF,SAAS,CAACnD,QAAD,CAAT,CACAsD,WAAW,GACX,GAAGD,EAAE,CAACE,MAAH,CAAU,CAAV,GAAgB,GAAnB,CAAuB,CACrBC,kBAAkB,CAACH,EAAD,CAAlB,CACD,CAFD,IAGI,CACFI,oBAAoB,CAACJ,EAAD,CAApB,CACD,CACF,CAED,QAASK,CAAAA,YAAT,CAAsBL,EAAtB,CAAyB,CACvBM,OAAO,CAACC,GAAR,CAAYhF,KAAZ,EACA6C,CAAC,CAAC4B,EAAF,CACA1B,YAAY,CAAC,EAAb,CACA3B,QAAQ,CAAG6D,YAAY,CAACR,EAAD,CAAvB,CACAM,OAAO,CAACC,GAAR,CAAY5D,QAAZ,EACA6C,2BAA2B,CAAC7C,QAAD,CAAWqD,EAAX,CAA3B,CACA3B,QAAQ,CAAGlC,IAAX,CACA,GAAG,CAACpB,KAAK,CAAC0F,MAAV,CACErB,mBAAmB,GACtB,CAED,QAASoB,CAAAA,YAAT,CAAsBR,EAAtB,CAAyB,CACvB,GAAIU,CAAAA,KAAK,CAAC,CAAV,CAAaC,KAAK,CAAC,CAAnB,CAAsBhE,QAAQ,CAAC,CAA/B,CACA,GAAGqD,EAAE,CAACE,MAAH,CAAU,CAAV,GAAc,GAAjB,CAAqB,CACnBQ,KAAK,CAAG,IAAIE,QAAQ,CAACZ,EAAE,CAACE,MAAH,CAAU,CAAV,CAAD,CAAR,CAAuB,CAA3B,CAAR,CACAS,KAAK,CAAG,EAAGC,QAAQ,CAACZ,EAAE,CAACE,MAAH,CAAU,CAAV,CAAD,CAAX,CAA2B,CAAnC,CACD,CAHD,IAIK,IAAGF,EAAE,CAACE,MAAH,CAAU,CAAV,GAAc,GAAjB,CAAqB,CACxBQ,KAAK,CAAG,IAAIE,QAAQ,CAACZ,EAAE,CAACE,MAAH,CAAU,CAAV,CAAD,CAAR,CAAuB,CAA3B,CAAR,CACAS,KAAK,CAAG,EAAGC,QAAQ,CAACZ,EAAE,CAACE,MAAH,CAAU,CAAV,CAAD,CAAX,CAA2B,CAAnC,CACD,CAHI,IAID,CACFQ,KAAK,CAAG,GAAIE,QAAQ,CAACZ,EAAE,CAACE,MAAH,CAAU,CAAV,CAAD,CAAZ,CAA4B,CAApC,CACAS,KAAK,CAAGC,QAAQ,CAACZ,EAAE,CAACE,MAAH,CAAU,CAAV,CAAD,CAAhB,CACD,CACDvD,QAAQ,CAAG+D,KAAK,CAAGC,KAAnB,CACA;AACA,MAAOhE,CAAAA,QAAP,CACD,CAED,QAASsD,CAAAA,WAAT,EAAsB,CACpB7D,OAAO,CAAC,SAAAD,IAAI,QAAEA,CAAAA,IAAI,GAAGJ,GAAP,CAAWC,IAAX,CAAgBD,GAAlB,EAAL,CAAP,CACA;AACD,CAED,QAAS8E,CAAAA,QAAT,CAAkBC,QAAlB,CAA2B,CACzB1E,OAAO,CAAC0E,QAAD,CAAP,CACD,CAED,QAASX,CAAAA,kBAAT,CAA4BH,EAA5B,CAA+B,CAC7B;AACA,GAAIe,CAAAA,GAAJ,CAASC,GAAT,CAAcC,GAAd,CAAmBC,GAAnB,CAAwBC,GAAxB,CAA6BC,GAA7B,CACA,GAAIC,CAAAA,IAAJ,CAAUC,IAAV,CAAgBC,IAAhB,CAAsBC,IAAtB,CAA4BC,IAA5B,CAAkCC,IAAlC,CACA,GAAIC,CAAAA,CAAC,CAAGf,QAAQ,CAACZ,EAAE,CAACE,MAAH,CAAU,CAAV,CAAD,CAAhB,CAAgC0B,CAAC,CAAGhB,QAAQ,CAACZ,EAAE,CAACE,MAAH,CAAU,CAAV,CAAD,CAA5C,CACAa,GAAG,CAAC,MAAMY,CAAC,CAAC,CAAR,EAAW,GAAX,CAAeC,CAAnB,CACAZ,GAAG,CAAC,MAAMW,CAAC,CAAC,CAAR,EAAW,GAAX,CAAeC,CAAnB,CACAX,GAAG,CAAC,MAAMU,CAAC,CAAC,CAAR,EAAW,GAAX,CAAeC,CAAnB,CACAV,GAAG,CAAC,MAAMS,CAAC,CAAC,CAAR,EAAW,GAAX,EAAgBC,CAAC,CAAC,CAAlB,CAAJ,CACAT,GAAG,CAAC,KAAMQ,CAAN,CAAS,GAAT,CAAaC,CAAjB,CACAR,GAAG,CAAC,KAAMO,CAAN,CAAS,GAAT,EAAcC,CAAC,CAAC,CAAhB,CAAJ,CACAP,IAAI,CAACb,YAAY,CAACO,GAAD,CAAjB,CACAO,IAAI,CAACd,YAAY,CAACQ,GAAD,CAAjB,CACAO,IAAI,CAACf,YAAY,CAACS,GAAD,CAAjB,CACAO,IAAI,CAAChB,YAAY,CAACU,GAAD,CAAjB,CACAO,IAAI,CAACjB,YAAY,CAACW,GAAD,CAAjB,CACAO,IAAI,CAAClB,YAAY,CAACY,GAAD,CAAjB,CAEA,GAAG9C,YAAY,EAAE,EAAjB,CAAoB,CAClB,GAAIwC,CAAAA,QAAQ,CAAG3E,IAAf,CACD,CAFD,IAGI,CACF,GAAI2E,CAAAA,QAAQ,CAAGxC,YAAf,CACD,CAED,GAAG/C,KAAK,CAACwE,GAAN,CAAUsB,IAAV,GAAiB,SAAjB,EAA8B9F,KAAK,CAACwE,GAAN,CAAUuB,IAAV,GAAkB,SAAhD,EAA6D/F,KAAK,CAACwE,GAAN,CAAUwB,IAAV,GAAiB,SAA9E,EAA2FhG,KAAK,CAACwE,GAAN,CAAUyB,IAAV,GAAkB,SAA7G,EAA0HjG,KAAK,CAACwE,GAAN,CAAU0B,IAAV,GAAiB,SAA3I,EAAwJlG,KAAK,CAACwE,GAAN,CAAU2B,IAAV,GAAkB,SAA7K,CAAuL,CACnLpB,OAAO,CAACC,GAAR,CAAY,8BAAZ,EACF7E,SAAS,CAACD,MAAM,CAACmE,GAAP,CAAY,MAAM+B,CAAC,CAAC,CAAR,EAAW,GAAX,CAAeC,CAA3B,CAA+Bd,QAA/B,CAAD,CAAT,CACApF,SAAS,CAACD,MAAM,CAACmE,GAAP,CAAY,KAAK+B,CAAL,CAAO,GAAP,CAAWC,CAAvB,CAA2Bd,QAA3B,CAAD,CAAT,CACAD,QAAQ,CAACC,QAAD,CAAR,CACAe,WAAW,CAAE,MAAMF,CAAC,CAAC,CAAR,EAAW,GAAX,CAAeC,CAAjB,CAAX,CACAC,WAAW,CAAE,KAAKF,CAAL,CAAO,GAAP,CAAWC,CAAb,CAAX,CACAE,WAAW,GACZ,CARD,IASK,IAAGvG,KAAK,CAACwE,GAAN,CAAUsB,IAAV,GAAiB,SAAjB,EAA8B9F,KAAK,CAACwE,GAAN,CAAUwB,IAAV,GAAkB,SAAhD,EAA6DhG,KAAK,CAACwE,GAAN,CAAUyB,IAAV,GAAiB,SAAjF,CAA2F,CAC5FlB,OAAO,CAACC,GAAR,CAAY,kBAAZ,EACF7E,SAAS,CAACD,MAAM,CAACmE,GAAP,CAAY,MAAM+B,CAAC,CAAC,CAAR,EAAW,GAAX,CAAeC,CAA3B,CAA+Bd,QAA/B,CAAD,CAAT,CACAD,QAAQ,CAACC,QAAD,CAAR,CACAe,WAAW,CAAE,MAAMF,CAAC,CAAC,CAAR,EAAW,GAAX,CAAeC,CAAjB,CAAX,CACAE,WAAW,GACZ,CANI,IAOA,IAAGvG,KAAK,CAACwE,GAAN,CAAUuB,IAAV,GAAkB,SAAlB,EAA+B/F,KAAK,CAACwE,GAAN,CAAU0B,IAAV,GAAiB,SAAhD,EAA6DlG,KAAK,CAACwE,GAAN,CAAU2B,IAAV,GAAkB,SAAlF,CAA4F,CAC7FpB,OAAO,CAACC,GAAR,CAAY,kBAAZ,EACF7E,SAAS,CAACD,MAAM,CAACmE,GAAP,CAAY,KAAK+B,CAAL,CAAO,GAAP,CAAWC,CAAvB,CAA2Bd,QAA3B,CAAD,CAAT,CACAD,QAAQ,CAACC,QAAD,CAAR,CACAe,WAAW,CAAE,KAAKF,CAAL,CAAO,GAAP,CAAWC,CAAb,CAAX,CACAE,WAAW,GACZ,CAED;AACAxD,YAAY,CAACwC,QAAb,CACD,CAED,QAASV,CAAAA,oBAAT,CAA8BJ,EAA9B,CAAiC,CAC/B;AACA,GAAIe,CAAAA,GAAJ,CAASC,GAAT,CAAcC,GAAd,CAAmBC,GAAnB,CAAwBC,GAAxB,CAA6BC,GAA7B,CACA,GAAIC,CAAAA,IAAJ,CAAUC,IAAV,CAAgBC,IAAhB,CAAsBC,IAAtB,CAA4BC,IAA5B,CAAkCC,IAAlC,CACA,GAAIC,CAAAA,CAAC,CAAGf,QAAQ,CAACZ,EAAE,CAACE,MAAH,CAAU,CAAV,CAAD,CAAhB,CAAgC0B,CAAC,CAAGhB,QAAQ,CAACZ,EAAE,CAACE,MAAH,CAAU,CAAV,CAAD,CAA5C,CACAa,GAAG,CAAC,KAAMY,CAAN,CAAS,GAAT,EAAcC,CAAC,CAAC,CAAhB,CAAJ,CACAZ,GAAG,CAAC,KAAMW,CAAN,CAAS,GAAT,EAAcC,CAAC,CAAC,CAAhB,CAAJ,CACAX,GAAG,CAAC,MAAMU,CAAC,CAAC,CAAR,EAAW,GAAX,EAAgBC,CAAC,CAAC,CAAlB,CAAJ,CACAV,GAAG,CAAC,KAAMS,CAAN,CAAS,GAAT,CAAcC,CAAlB,CACAT,GAAG,CAAC,KAAMQ,CAAN,CAAS,GAAT,EAAcC,CAAC,CAAC,CAAhB,CAAJ,CACAR,GAAG,CAAC,MAAMO,CAAC,CAAC,CAAR,EAAW,GAAX,CAAgBC,CAApB,CACAP,IAAI,CAACb,YAAY,CAACO,GAAD,CAAjB,CACAO,IAAI,CAACd,YAAY,CAACQ,GAAD,CAAjB,CACAO,IAAI,CAACf,YAAY,CAACS,GAAD,CAAjB,CACAO,IAAI,CAAChB,YAAY,CAACU,GAAD,CAAjB,CACAO,IAAI,CAACjB,YAAY,CAACW,GAAD,CAAjB,CACAO,IAAI,CAAClB,YAAY,CAACY,GAAD,CAAjB,CAEA,GAAG9C,YAAY,EAAE,EAAjB,CAAoB,CAClB,GAAIwC,CAAAA,QAAQ,CAAG3E,IAAf,CACD,CAFD,IAGI,CACF,GAAI2E,CAAAA,QAAQ,CAAGxC,YAAf,CACD,CAED,GAAG/C,KAAK,CAACwE,GAAN,CAAUsB,IAAV,GAAiB,SAAjB,EAA8B9F,KAAK,CAACwE,GAAN,CAAUuB,IAAV,GAAkB,SAAhD,EAA6D/F,KAAK,CAACwE,GAAN,CAAUwB,IAAV,GAAiB,SAA9E,EAA2FhG,KAAK,CAACwE,GAAN,CAAUyB,IAAV,GAAkB,SAA7G,EAA0HjG,KAAK,CAACwE,GAAN,CAAU0B,IAAV,GAAiB,SAA3I,EAAwJlG,KAAK,CAACwE,GAAN,CAAU2B,IAAV,GAAkB,SAA7K,CAAuL,CACrLpB,OAAO,CAACC,GAAR,CAAY,6BAAZ,EACA7E,SAAS,CAACD,MAAM,CAACmE,GAAP,CAAW,KAAK+B,CAAL,CAAO,GAAP,EAAYC,CAAC,CAAC,CAAd,CAAX,CAA6Bd,QAA7B,CAAD,CAAT,CACApF,SAAS,CAACD,MAAM,CAACmE,GAAP,CAAY,KAAK+B,CAAL,CAAO,GAAP,CAAWC,CAAvB,CAA2Bd,QAA3B,CAAD,CAAT,CACAD,QAAQ,CAACC,QAAD,CAAR,CACAe,WAAW,CAAE,KAAKF,CAAL,CAAO,GAAP,EAAYC,CAAC,CAAC,CAAd,CAAF,CAAX,CACAC,WAAW,CAAE,KAAKF,CAAL,CAAO,GAAP,CAAWC,CAAb,CAAX,CACAE,WAAW,GACZ,CARD,IASK,IAAGvG,KAAK,CAACwE,GAAN,CAAUsB,IAAV,GAAiB,SAAjB,EAA8B9F,KAAK,CAACwE,GAAN,CAAUuB,IAAV,GAAkB,SAAhD,EAA6D/F,KAAK,CAACwE,GAAN,CAAUwB,IAAV,GAAiB,SAAjF,CAA2F,CAC9FjB,OAAO,CAACC,GAAR,CAAY,iBAAZ,EACA7E,SAAS,CAACD,MAAM,CAACmE,GAAP,CAAW,KAAK+B,CAAL,CAAO,GAAP,EAAYC,CAAC,CAAC,CAAd,CAAX,CAA6Bd,QAA7B,CAAD,CAAT,CACAD,QAAQ,CAACC,QAAD,CAAR,CACAe,WAAW,CAAE,KAAKF,CAAL,CAAO,GAAP,EAAYC,CAAC,CAAC,CAAd,CAAF,CAAX,CACAE,WAAW,GACZ,CANI,IAOA,IAAGvG,KAAK,CAACwE,GAAN,CAAUyB,IAAV,GAAkB,SAAlB,EAA+BjG,KAAK,CAACwE,GAAN,CAAU0B,IAAV,GAAiB,SAAhD,EAA6DlG,KAAK,CAACwE,GAAN,CAAU2B,IAAV,GAAkB,SAAlF,CAA4F,CAC/FpB,OAAO,CAACC,GAAR,CAAY,kBAAZ,EACA7E,SAAS,CAACD,MAAM,CAACmE,GAAP,CAAY,KAAK+B,CAAL,CAAO,GAAP,CAAWC,CAAvB,CAA2Bd,QAA3B,CAAD,CAAT,CACAD,QAAQ,CAACC,QAAD,CAAR,CACAe,WAAW,CAAE,KAAKF,CAAL,CAAO,GAAP,CAAWC,CAAb,CAAX,CACAE,WAAW,GACZ,CACD;AACAxD,YAAY,CAACwC,QAAb,CACD,CAED,QAASe,CAAAA,WAAT,CAAqBE,SAArB,CAA+B,CAC7B,GAAGtG,MAAM,CAACsE,GAAP,CAAWgC,SAAX,GAAuBhG,GAA1B,CAA8B,CAC5BO,WAAW,CAAC,SAAAD,QAAQ,QAAEA,CAAAA,QAAQ,CAAC,CAAX,EAAT,CAAX,CACD,CAFD,IAGK,IAAGZ,MAAM,CAACsE,GAAP,CAAWgC,SAAX,GAAuB/F,IAA1B,CAA+B,CAClCQ,YAAY,CAAC,SAAAD,SAAS,QAAEA,CAAAA,SAAS,CAAC,CAAZ,EAAV,CAAZ,CACD,CACF,CAED,QAASuF,CAAAA,WAAT,EAAsB,CACpB5G,YAAY,CAAC,CAAb,CADoB,yCAEOO,MAAM,CAACuG,OAAP,EAFP,YAEpB,+CAA6C,+CAAjCC,GAAiC,gBAA5BC,KAA4B,gBAC3C,GAAGA,KAAK,EAAE,aAAV,CAAwB,CACtB;AACAhH,YAAY,GACb,CACF,CAPmB,qDAQpBoF,OAAO,CAACC,GAAR,CAAY,iBAAiBrF,YAA7B,EACA,GAAGH,KAAK,CAAC4E,QAAN,EAAkB,CAArB,CAAuB,CACrB,GAAGzE,YAAY,EAAI,EAAnB,CAAsB,CACpBwB,WAAW,CAAC,IAAD,CAAX,CACD,CACF,CAJD,IAKK,IAAG3B,KAAK,CAAC4E,QAAN,EAAkB,CAArB,CAAuB,CAC1B,GAAGzE,YAAY,EAAI,EAAnB,CAAsB,CACpBwB,WAAW,CAAC,IAAD,CAAX,CACD,CACF,CACD;AACA;AACA;AACA;AACA;AACA;AACA;AACD,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,GAAMyF,CAAAA,kBAAkB,CAAGnI,MAAM,CAAC,IAAD,CAAjC,CACAD,SAAS,CAAC,UAAM,CACd,GAAIwE,CAAAA,MAAM,CAAGC,IAAI,CAACC,SAAL,CAAeC,MAAM,CAACC,QAAP,CAAgBC,IAA/B,CAAb,CACA,GAAIwD,CAAAA,UAAJ,CACA,GAAG7D,MAAM,CAACM,SAAP,CAAiBN,MAAM,CAACO,MAAP,CAAc,CAA/B,CAAkCP,MAAM,CAACO,MAAP,CAAc,CAAhD,GAAoD,SAAvD,CAAiE,CAC/DsD,UAAU,CAAG,IAAb,CACD,CACD,GAAG,CAACA,UAAD,EAAe,CAAC3F,QAAnB,CAA4B,CAC1B,GAAI4F,CAAAA,WAAW,CAAGpG,aAAa,EAAE,SAAf,CAAyB,KAAzB,CAA+B,MAAjD,CACAkG,kBAAkB,CAACG,OAAnB,CAA6B/H,KAAK,CAAC,WAAW8H,WAAZ,CAAyB,CACzD1F,QAAQ,CAAE,WAD+C,CAEzD4F,SAAS,CAAE,IAF8C,CAGzDC,eAAe,CAAE,IAHwC,CAIzDC,YAAY,CAAE,IAJ2C,CAKzDC,YAAY,CAAE,KAL2C,CAMzDC,SAAS,CAAE,IAN8C,CAOzDC,QAAQ,CAAEC,SAP+C,CAAzB,CAAlC,CASD,CACF,CAlBQ,CAkBN,CAACpG,QAAD,CAAW1B,KAAK,CAAC0F,MAAjB,CAlBM,CAAT,CAoBA,QAASqC,CAAAA,WAAT,EAAsB,CACpBvI,KAAK,CAAC,oBAAD,CAAuB,CAC1BoC,QAAQ,CAAE,WADgB,CAE1B4F,SAAS,CAAE,IAFe,CAG1BC,eAAe,CAAE,IAHS,CAI1BC,YAAY,CAAE,IAJY,CAK1BC,YAAY,CAAE,KALY,CAM1BC,SAAS,CAAE,IANe,CAO1BC,QAAQ,CAAEC,SAPgB,CAAvB,CAAL,CASD,CAED,QAASE,CAAAA,WAAT,CAAqBC,WAArB,CAAkC9G,UAAlC,CAA6C,CAC3C,GAAG8G,WAAW,EAAE,EAAhB,CAAmB,CACf,OACH,CACDpI,MAAM,CAACsE,IAAP,CAAY,cAAZ,CAA4B,CAACD,MAAM,CAAEjC,WAAT,CAAsBgG,WAAW,CAAEA,WAAnC,CAAgD9G,UAAU,CAAEA,UAA5D,CAA5B,EACD,CAEDtB,MAAM,CAACqI,GAAP,CAAW,iBAAX,EACArI,MAAM,CAACuE,EAAP,CAAU,iBAAV,CAA6B,SAAC6D,WAAD,CAAc9G,UAAd,CAA2B,CACpDoE,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAEA,GAAM2C,CAAAA,cAAc,oBAAOhG,UAAP,CAApB,CACAgG,cAAc,CAACC,IAAf,CAAoB,CAACC,MAAM,CAAElH,UAAT,CAAqBmH,OAAO,CAAEL,WAA9B,CAApB,EACA1C,OAAO,CAACC,GAAR,CAAY2C,cAAZ,EACA/F,aAAa,CAAC+F,cAAD,CAAb,CACD,CAPH,EASEnJ,SAAS,CAAC,UAAI,CACZ;AACA;AACA;AACA,GAAGqD,QAAH,CAAY,CACVK,WAAW,CAACP,UAAU,CAAC4B,MAAZ,CAAX,CACAvB,cAAc,CAAC,CAAD,CAAd,CACD,CACD,GAAI+F,CAAAA,eAAe,CAAGpG,UAAU,CAAC4B,MAAX,CAAkBtB,QAAxC,CACAD,cAAc,CAAC+F,eAAD,CAAd,CACD,CAVQ,CAUN,CAAClG,QAAD,CAVM,CAAT,CAYArD,SAAS,CAAC,UAAI,CACZ,GAAGqD,QAAH,CAAY,CACVG,cAAc,CAAC,CAAD,CAAd,CACAE,WAAW,CAACP,UAAU,CAAC4B,MAAZ,CAAX,CACD,CAHD,IAII,CACF,GAAIwE,CAAAA,eAAe,CAAGpG,UAAU,CAAC4B,MAAX,CAAkBtB,QAAxC,CACAD,cAAc,CAAC+F,eAAD,CAAd,CACD,CACF,CATQ,CASN,CAACpG,UAAU,CAAC4B,MAAZ,CATM,CAAT,CAWA/E,SAAS,CAAC,UAAM,CACd,GAAGqD,QAAH,CAAY,IACDmG,CAAAA,kBADC,CACV,QAASA,CAAAA,kBAAT,CAA4BC,KAA5B,CAAmC,CACjC,GAAI9F,OAAO,CAAC4E,OAAR,EAAmB,CAAC5E,OAAO,CAAC4E,OAAR,CAAgBmB,QAAhB,CAAyBD,KAAK,CAACE,MAA/B,CAApB,EAA8D/F,OAAO,CAAC2E,OAAtE,EAAiF,CAAC3E,OAAO,CAAC2E,OAAR,CAAgBmB,QAAhB,CAAyBD,KAAK,CAACE,MAA/B,CAAlF,EAA4H9F,aAAa,CAAC0E,OAA1I,EAAqJ,CAAC1E,aAAa,CAAC0E,OAAd,CAAsBmB,QAAtB,CAA+BD,KAAK,CAACE,MAArC,CAA1J,CAAwM,CACtMrG,WAAW,CAAC,KAAD,CAAX,CACD,CACF,CALS,CAMVsG,QAAQ,CAACC,gBAAT,CAA0B,WAA1B,CAAuCL,kBAAvC,EACA,MAAO,WAAM,CACXI,QAAQ,CAACE,mBAAT,CAA6B,WAA7B,CAA0CN,kBAA1C,EACD,CAFD,CAGD,CACF,CAZQ,CAYN,CAACnG,QAAD,CAZM,CAAT,CAcA;AACArD,SAAS,CAAC,UAAI,CACZ,GAAG,CAACgB,KAAK,CAAC0F,MAAV,CAAiB,CACf,CAAChE,QAAD,EAAa7B,MAAM,CAACuE,EAAP,CAAU,WAAV,CAAuB,eAAY,IAAV2E,CAAAA,MAAU,OAAVA,MAAU,CAC9CxD,OAAO,CAACC,GAAR,CAAY,gCAAZ,EACAvC,aAAa,CAAC,IAAD,CAAb,CACAtB,WAAW,CAAC,IAAD,CAAX,CACAoB,kBAAkB,CAACgG,MAAD,CAAlB,CACD,CALY,CAAb,CAMD,CACF,CATQ,CASN,CAAClJ,MAAD,CATM,CAAT,CAWAb,SAAS,CAAC,UAAI,CACZ,GAAG,CAACgB,KAAK,CAAC0F,MAAV,CAAiB,CACf,GAAIzB,CAAAA,UAAU,CAAGhC,WAAjB,CACA,GAAG,CAACe,UAAJ,CAAe,CACb,GAAMgG,CAAAA,UAAU,CAAGC,WAAW,CAAC,UAAM,CACnCpJ,MAAM,CAACsE,IAAP,CAAY,kBAAZ,CAAiC,CAAChD,UAAU,CAAEnB,KAAK,CAACmB,UAAnB,CAA+B+C,MAAM,CAAED,UAAvC,CAAjC,EACD,CAF6B,CAE3B,IAF2B,CAA9B,CAGD,CACF,CACF,CATQ,CASN,CAAChC,WAAD,CATM,CAAT,CAWA0B,MAAM,CAACkF,gBAAP,CAAwB,UAAxB,CAAoC,SAACJ,KAAD,CAAW,CAC7C,GAAIA,KAAK,CAACS,KAAV,CAAiB,CACfvF,MAAM,CAACC,QAAP,CAAgBuF,MAAhB,GACD,CACD,CAJF,CAII,KAJJ,EAMAnK,SAAS,CAAC,UAAI,CACZ2E,MAAM,CAACP,OAAP,CAAegG,SAAf,CAAyB,CAACC,IAAI,CAAE,aAAP,CAAzB,CAAgD,uBAAhD,CAAyE1F,MAAM,CAACC,QAAP,CAAgBC,IAAzF,EACAF,MAAM,CAACP,OAAP,CAAegG,SAAf,CAAyB,CAACC,IAAI,CAAE,aAAP,CAAzB,CAAgD,uBAAhD,CAAyE1F,MAAM,CAACC,QAAP,CAAgBC,IAAzF,EACD,CAHQ,CAGN,EAHM,CAAT,CAKF,mBACE,wCACE,KAAC,MAAD,EAAQ,QAAQ,CAAE7D,KAAK,CAAC4E,QAAxB,CAAkC,QAAQ,CAAElD,QAA5C,CAAsD,WAAW,CAAE,IAAnE,CAAyE,MAAM,CAAE1B,KAAK,CAAC0F,MAAvF,EADF,cAEE,aAAK,SAAS,CAAC,kBAAf,wBACE,YAAK,SAAS,CAAE,CAAChE,QAAD,CAAU,WAAV,CAAsB,WAAtC,CAAmD,GAAG,CAAEkB,OAAxD,uBACE,KAAC,IAAD,EACE,QAAQ,CAAE5C,KAAK,CAAC4E,QADlB,CAEE,IAAI,CAAEU,YAFR,CAGE,IAAI,CAAElE,IAHR,CAIE,GAAG,CAAEZ,KAJP,CAKE,MAAM,CAAEE,MALV,CAME,MAAM,CAAEV,KAAK,CAAC0F,MANhB,CAOE,SAAS,CAAE3D,SAPb,CAQE,MAAM,CAAEF,MARV,CASE,aAAa,CAAEX,aATjB,CAUE,WAAW,CAAI6G,WAVjB,EADF,EADF,cAgBE,YAAK,SAAS,CAAE,CAACrG,QAAD,CAAU,gBAAV,CAA2B,gBAA3C,uBACE,KAAC,QAAD,EAAU,eAAe,CAAEoB,eAA3B,CAA4C,QAAQ,CAAExB,QAAtD,CAAgE,SAAS,CAAEE,SAA3E,CAAsF,QAAQ,CAAExB,KAAK,CAAC4E,QAAtG,CAAgH,MAAM,CAAElE,MAAxH,CAAgI,MAAM,CAAEV,KAAK,CAAC0F,MAA9I,CAAsJ,QAAQ,CAAEhE,QAAhK,EADF,EAhBF,cAoBE,aAAK,SAAS,CAAE,CAACA,QAAD,CAAU,iBAAV,CAA4B,sBAA5C,wBACE,YAAI,SAAS,CAAC,OAAd,CAAsB,EAAE,CAAEN,IAAI,EAAEJ,GAAN,CAAU,gBAAV,CAA2B,WAArD,mBAAwEM,QAAxE,GADF,cAEE,YAAI,SAAS,CAAC,OAAd,CAAsB,EAAE,CAAEF,IAAI,EAAEH,IAAN,CAAW,iBAAX,CAA6B,YAAvD,oBAA4EO,SAA5E,GAFF,GApBF,GAFF,CA2BC,CAACxB,KAAK,CAAC0F,MAAP,eAAe,YAAK,SAAS,CAAExE,aAAa,EAAEF,GAAf,CAAmB,2BAAnB,CAA+C,4BAA/D,uBACd,YAAK,GAAG,CAAE6B,aAAV,CAAyB,SAAS,CAAC,aAAnC,CAAiD,OAAO,CAAE,kBAAI,CAC5DP,WAAW,CAAC,CAACD,QAAF,CAAX,CACD,CAFD,uBAIE,YAAK,SAAS,CAAC,wBAAf,CAAwC,KAAK,CAAE,CAACiH,UAAU,CAAE/G,WAAW,EAAE,CAAb,CAAe,QAAf,CAAwB,SAArC,CAA/C,UACGA,WADH,EAJF,EADc,EA3BhB,CAqCC,CAACvC,KAAK,CAAC0F,MAAP,eACC,YAAK,GAAG,CAAE/C,OAAV,uBACE,KAAC,IAAD,EAAM,WAAW,CAAEqF,WAAnB,CAAgC,UAAU,CAAE7F,UAA5C,CAAwD,SAAS,CAAEjB,aAAnE,CAAkF,MAAM,CAAEe,WAA1F,CAAuG,UAAU,CAAEjC,KAAK,CAACmB,UAAzH,CAAqI,QAAQ,CAAEkB,QAA/I,EADF,EAtCF,cA0CA,KAAC,cAAD,IA1CA,GADF,CA8CD","sourcesContent":["import logo from './logo.svg';\nimport './App.css';\nimport react, {useState, useEffect, useRef} from 'react';\nimport \"./style.css\";\nimport Dot from './Components/Dot';\nimport Grid from './Components/Grid';\nimport GameOver from './Components/GameOver';\nimport Header from './Components/Header';\nimport {io} from \"socket.io-client\";\nimport { ToastContainer, toast } from 'react-toastify';\nimport { css } from \"glamor\";\nimport Chat from './Components/Chat';\nimport { useNavigate } from 'react-router-dom';\nimport { useBeforeunload } from 'react-beforeunload';\n\nconst socket = io('https://baksa19.herokuapp.com/', { transports : ['websocket'] });\n\nexport default function Game(props) {\n  var i, j;\n  var tempBoxCount = 0;\n  var compTempPos;\n  var compBoxFlag = false;\n  var comp2line = false;\n  const [elMap, setMap] = useState(new Map());\n  const [boxMap, setBoxMap] = useState(new Map());\n  \n  const [mapFlag, setMapFlag] = useState(true); //used to make sure the map is initialised only once\n  const [boxFlag, setBoxFlag] = useState(true); //used to make sure the box map is initialised only once\n  \n  var red=\"#c5183b\";\n  var blue=\"#3b919b\";\n  const assignedColor = props.playerRole==1?red:blue;\n\n  const [turn, setTurn] = useState(red);\n  const [redScore, setRedScore] = useState(0);\n  const [blueScore, setBlueScore] = useState(0);\n\n  const [gameOver, setGameOver] = useState(false);\n  var position;\n  const [tempId, setTempId] = useState(\"\");\n  const [tempColor, setTempColor] = useState(\"\");\n\n  const [finalRoomId, setFinalRoomId] = useState(\"\");\n  \n  const [messageArr, setMessageArr] = useState([]);\n  const [showChat, setShowChat] = useState(false);\n  const [unreadCount, setUnreadCount] = useState(0);\n  const [lastSeen, setLastSeen] = useState(0);\n\n  const chatRef = useRef();\n  const gridRef = useRef();\n  const chatButtonRef = useRef();\n\n  const [gameLeaveWinner, setGameLeaveWinner] = useState(\"none\");\n  const [playerLeft, setPlayerLeft] = useState(false);\n  const [ locationKeys, setLocationKeys ] = useState([])\n  const history = useNavigate()\n\n  var t; // variable for temporarily handling id\n  var tempTurn; // variable for temporarily handling turn\n  var tempBoxColor=\"\";\n\n\n  useEffect(()=>{\n    var curUrl = JSON.stringify(window.location.href);\n    if(curUrl.substring(curUrl.length-8, curUrl.length-1)==\"offline\"){\n      props.setVsComp(true);\n    }\n  }, [])\n\n  useEffect(()=>{\n    var tempRoomId = props.roomId+\"1\";\n    socket.emit(\"rejoin\", {roomId: tempRoomId});\n  }, [])\n\n  useEffect(()=>{\n    socket.on(\"final-room\", ({roomId})=>{\n      // console.log(roomId);\n      setFinalRoomId(roomId);\n    })\n  }, [socket]);\n\n  function updateMapWithServer(){\n    // console.log(\"received\");\n    // socket.emit(\"test\", {roomId: finalRoomId, socketId: props.socketId});\n    socket.emit(\"update\", {turn: tempTurn, roomId: finalRoomId, socketId: props.socketId, position: position, tempId: t, tempBoxColor: tempBoxColor});\n  }\n  \n  useEffect(()=>{\n    // console.log(socket);\n    socket.on(\"updated\", (data)=>{\n      position = data.position;\n      tempBoxColor = data.tempBoxColor;\n      updateLocalVariablesWithServerValues(data.tempId, data.turn);\n      elementCheckUtilityFunction(position, data.tempId);\n    });\n  }, [socket]);\n\n  function updateLocalVariablesWithServerValues(tempId, tempColor){\n    setTempId(tempId);\n    setTempColor(tempColor);\n  }\n\n  (function initMap(){\n    if(mapFlag){\n      var tempSize = props.gridSize==4?65:225;\n      for(i=0; i<tempSize; ++i){\n      // for(i=0; i<props.gridSize==4?65:225; ++i){\n        elMap.set(i, \"unclicked\");\n      }\n      setMapFlag(false);\n    }\n  })();\n\n  (function initBoxMap(){\n    if(boxFlag){\n      for(i=1; i<=props.gridSize; ++i){\n      // for(i=1; i<=4; ++i){\n        for(j=1; j<=props.gridSize; ++j)\n        // for(j=1; j<=4; ++j)\n          boxMap.set(\"b-\"+i+\"-\"+j, \"transparent\");\n      }\n      setBoxFlag(false);\n    }\n  })();\n\n  function updateMap(position){\n    if(elMap.get(position)!==\"clicked\"){\n      setMap(elMap.set(position, \"clicked\"));\n      // console.log(elMap);\n    }\n  }\n\n  function elementCheckUtilityFunction(position, id){\n    // console.log(\"here\");\n    updateMap(position);\n    setTurnFunc();\n    if(id.charAt(0) == \"h\"){\n      checkVerticalBoxes(id);\n    }\n    else{\n      checkHorizontalBoxes(id);\n    }\n  }\n\n  function elementCheck(id){\n    console.log(elMap);\n    t=id;\n    tempBoxColor=\"\"\n    position = calcPosition(id);\n    console.log(position);\n    elementCheckUtilityFunction(position, id);\n    tempTurn = turn;\n    if(!props.vsComp)\n      updateMapWithServer();\n  }\n  \n  function calcPosition(id){\n    var part1=0, part2=0, position=0;\n    if(id.charAt(0)==\"d\"){\n      part1 = 14*(parseInt(id.charAt(2))-1);\n      part2 = 2*(parseInt(id.charAt(4)))-2;\n    }\n    else if(id.charAt(0)==\"h\"){\n      part1 = 14*(parseInt(id.charAt(2))-1);\n      part2 = 2*(parseInt(id.charAt(4)))-1;\n    }\n    else{\n      part1 = 14*(parseInt(id.charAt(2)))-5;\n      part2 = parseInt(id.charAt(4));\n    }\n    position = part1 + part2;\n    // console.log(position);\n    return position;\n  }\n\n  function setTurnFunc(){\n    setTurn(turn=>turn===red?blue:red);\n    // console.log(\"In the setTurn function: \"+turn);\n  }\n\n  function stayTurn(boxColor){\n    setTurn(boxColor);\n  }\n\n  function checkVerticalBoxes(id){\n    // console.log(id);\n    var id1, id2, id3, id4, id5, id6;\n    var pos1, pos2, pos3, pos4, pos5, pos6;\n    var n = parseInt(id.charAt(2)), m = parseInt(id.charAt(4));\n    id1=\"h-\"+(n-1)+\"-\"+m;\n    id2=\"h-\"+(n+1)+\"-\"+m;\n    id3=\"v-\"+(n-1)+\"-\"+m;\n    id4=\"v-\"+(n-1)+\"-\"+(m+1);\n    id5=\"v-\"+(n)+\"-\"+m;\n    id6=\"v-\"+(n)+\"-\"+(m+1);\n    pos1=calcPosition(id1);\n    pos2=calcPosition(id2);\n    pos3=calcPosition(id3);\n    pos4=calcPosition(id4);\n    pos5=calcPosition(id5);\n    pos6=calcPosition(id6);\n    \n    if(tempBoxColor==\"\"){\n      var boxColor = turn;\n    }\n    else{\n      var boxColor = tempBoxColor;\n    }\n\n    if(elMap.get(pos1)==\"clicked\" && elMap.get(pos2)== \"clicked\" && elMap.get(pos3)==\"clicked\" && elMap.get(pos4)== \"clicked\" && elMap.get(pos5)==\"clicked\" && elMap.get(pos6)== \"clicked\"){\n        console.log(\"upper and lower boxes filled\");\n      setBoxMap(boxMap.set((\"b-\"+(n-1)+\"-\"+m), boxColor));\n      setBoxMap(boxMap.set((\"b-\"+n+\"-\"+m), boxColor));\n      stayTurn(boxColor);\n      updateScore((\"b-\"+(n-1)+\"-\"+m));\n      updateScore((\"b-\"+n+\"-\"+m));\n      updateTotal();\n    }\n    else if(elMap.get(pos1)==\"clicked\" && elMap.get(pos3)== \"clicked\" && elMap.get(pos4)==\"clicked\"){\n        console.log(\"upper box filled\");\n      setBoxMap(boxMap.set((\"b-\"+(n-1)+\"-\"+m), boxColor));\n      stayTurn(boxColor);\n      updateScore((\"b-\"+(n-1)+\"-\"+m));\n      updateTotal();\n    }\n    else if(elMap.get(pos2)== \"clicked\" && elMap.get(pos5)==\"clicked\" && elMap.get(pos6)== \"clicked\"){\n        console.log(\"lower box filled\");\n      setBoxMap(boxMap.set((\"b-\"+n+\"-\"+m), boxColor));\n      stayTurn(boxColor);\n      updateScore((\"b-\"+n+\"-\"+m));\n      updateTotal();\n    }\n\n    // console.log(boxMap);\n    tempBoxColor=boxColor;\n  }\n  \n  function checkHorizontalBoxes(id){\n    // console.log(id);\n    var id1, id2, id3, id4, id5, id6;\n    var pos1, pos2, pos3, pos4, pos5, pos6;\n    var n = parseInt(id.charAt(2)), m = parseInt(id.charAt(4));\n    id1=\"h-\"+(n)+\"-\"+(m-1);\n    id2=\"v-\"+(n)+\"-\"+(m-1);\n    id3=\"h-\"+(n+1)+\"-\"+(m-1);\n    id4=\"h-\"+(n)+\"-\"+(m);\n    id5=\"v-\"+(n)+\"-\"+(m+1);\n    id6=\"h-\"+(n+1)+\"-\"+(m);\n    pos1=calcPosition(id1);\n    pos2=calcPosition(id2);\n    pos3=calcPosition(id3);\n    pos4=calcPosition(id4);\n    pos5=calcPosition(id5);\n    pos6=calcPosition(id6);\n\n    if(tempBoxColor==\"\"){\n      var boxColor = turn;\n    }\n    else{\n      var boxColor = tempBoxColor;\n    }\n\n    if(elMap.get(pos1)==\"clicked\" && elMap.get(pos2)== \"clicked\" && elMap.get(pos3)==\"clicked\" && elMap.get(pos4)== \"clicked\" && elMap.get(pos5)==\"clicked\" && elMap.get(pos6)== \"clicked\"){\n      console.log(\"left and right boxes filled\");\n      setBoxMap(boxMap.set(\"b-\"+n+\"-\"+(m-1), boxColor));\n      setBoxMap(boxMap.set((\"b-\"+n+\"-\"+m), boxColor));\n      stayTurn(boxColor);\n      updateScore((\"b-\"+n+\"-\"+(m-1)));\n      updateScore((\"b-\"+n+\"-\"+m));\n      updateTotal();\n    }\n    else if(elMap.get(pos1)==\"clicked\" && elMap.get(pos2)== \"clicked\" && elMap.get(pos3)==\"clicked\"){\n      console.log(\"left box filled\");\n      setBoxMap(boxMap.set(\"b-\"+n+\"-\"+(m-1), boxColor));\n      stayTurn(boxColor);\n      updateScore((\"b-\"+n+\"-\"+(m-1)));\n      updateTotal();\n    }\n    else if(elMap.get(pos4)== \"clicked\" && elMap.get(pos5)==\"clicked\" && elMap.get(pos6)== \"clicked\"){\n      console.log(\"right box filled\");\n      setBoxMap(boxMap.set((\"b-\"+n+\"-\"+m), boxColor));\n      stayTurn(boxColor);\n      updateScore((\"b-\"+n+\"-\"+m));\n      updateTotal();\n    }\n    // console.log(boxMap);\n    tempBoxColor=boxColor;\n  }\n\n  function updateScore(tempBoxId){\n    if(boxMap.get(tempBoxId)==red){\n      setRedScore(redScore=>redScore+1);\n    }\n    else if(boxMap.get(tempBoxId)==blue){\n      setBlueScore(blueScore=>blueScore+1);\n    }\n  }\n\n  function updateTotal(){\n    tempBoxCount=0;\n    for (const [key, value] of boxMap.entries()) {\n      if(value!=\"transparent\"){\n        // console.log(key+\": \"+value);\n        tempBoxCount++;\n      }\n    }\n    console.log(\"tempBoxCount: \"+tempBoxCount);\n    if(props.gridSize == 4){\n      if(tempBoxCount == 16){\n        setGameOver(true);\n      }\n    }\n    else if(props.gridSize == 8){\n      if(tempBoxCount == 64){\n        setGameOver(true);\n      }\n    }    \n    // console.log(\"totalScore: \"+(redScore+blueScore));\n    // if(props.gridSize == 4 && redScore+blueScore == 15){\n    //   setGameOver(true);\n    // }\n    // else if(props.gridSize == 8 && redScore+blueScore == 63){\n    //   setGameOver(true);\n    // }\n  }\n  \n  // function compCheckVerticalBoxes(id, elRef){\n  //   // console.log(id);\n  //   var id1, id2, id3, id4, id5, id6;\n  //   var pos1, pos2, pos3, pos4, pos5, pos6;\n  //   var n = parseInt(id.charAt(2)), m = parseInt(id.charAt(4));\n  //   id1=\"h-\"+(n-1)+\"-\"+m;\n  //   id2=\"h-\"+(n+1)+\"-\"+m;\n  //   id3=\"v-\"+(n-1)+\"-\"+m;\n  //   id4=\"v-\"+(n-1)+\"-\"+(m+1);\n  //   id5=\"v-\"+(n)+\"-\"+m;\n  //   id6=\"v-\"+(n)+\"-\"+(m+1);\n  //   pos1=calcPosition(id1);\n  //   pos2=calcPosition(id2);\n  //   pos3=calcPosition(id3);\n  //   pos4=calcPosition(id4);\n  //   pos5=calcPosition(id5);\n  //   pos6=calcPosition(id6);\n    \n  //   var boxColor = turn==blue?blue:red;\n\n  //   if(elMap.get(pos1)==\"clicked\" && elMap.get(pos2)== \"clicked\" && elMap.get(pos3)==\"clicked\" && elMap.get(pos4)== \"clicked\" && elMap.get(pos5)==\"clicked\" && elMap.get(pos6)== \"clicked\"){\n  //     compBoxFlag = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //     setBoxMap(boxMap.set((\"b-\"+(n-1)+\"-\"+m), boxColor));\n  //     setBoxMap(boxMap.set((\"b-\"+n+\"-\"+m), boxColor));\n  //     stayTurn();\n  //     updateScore((\"b-\"+(n-1)+\"-\"+m));\n  //     updateScore((\"b-\"+n+\"-\"+m));\n  //     updateTotal();\n  //   }\n  //   else if(elMap.get(pos1)==\"clicked\" && elMap.get(pos3)== \"clicked\" && elMap.get(pos4)==\"clicked\"){\n  //     compBoxFlag = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //     setBoxMap(boxMap.set((\"b-\"+(n-1)+\"-\"+m), boxColor));\n  //     stayTurn();\n  //     updateScore((\"b-\"+(n-1)+\"-\"+m));\n  //     updateTotal();\n  //   }\n  //   else if(elMap.get(pos2)== \"clicked\" && elMap.get(pos5)==\"clicked\" && elMap.get(pos6)== \"clicked\"){\n  //     compBoxFlag = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //     setBoxMap(boxMap.set((\"b-\"+n+\"-\"+m), boxColor));\n  //     stayTurn();\n  //     updateScore((\"b-\"+n+\"-\"+m));\n  //     updateTotal();\n  //   }\n  // }\n\n  // function compCheckHorizontalBoxes(id, elRef){\n  //   // console.log(id);\n  //   var id1, id2, id3, id4, id5, id6;\n  //   var pos1, pos2, pos3, pos4, pos5, pos6;\n  //   var n = parseInt(id.charAt(2)), m = parseInt(id.charAt(4));\n  //   id1=\"h-\"+(n)+\"-\"+(m-1);\n  //   id2=\"v-\"+(n)+\"-\"+(m-1);\n  //   id3=\"h-\"+(n+1)+\"-\"+(m-1);\n  //   id4=\"h-\"+(n)+\"-\"+(m);\n  //   id5=\"v-\"+(n)+\"-\"+(m+1);\n  //   id6=\"h-\"+(n+1)+\"-\"+(m);\n  //   pos1=calcPosition(id1);\n  //   pos2=calcPosition(id2);\n  //   pos3=calcPosition(id3);\n  //   pos4=calcPosition(id4);\n  //   pos5=calcPosition(id5);\n  //   pos6=calcPosition(id6);\n\n  //   var boxColor = turn==blue?blue:red;\n\n  //   if(elMap.get(pos1)==\"clicked\" && elMap.get(pos2)== \"clicked\" && elMap.get(pos3)==\"clicked\" && elMap.get(pos4)== \"clicked\" && elMap.get(pos5)==\"clicked\" && elMap.get(pos6)== \"clicked\"){\n  //     compBoxFlag = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //     setBoxMap(boxMap.set(\"b-\"+n+\"-\"+(m-1), boxColor));\n  //     setBoxMap(boxMap.set((\"b-\"+n+\"-\"+m), boxColor));\n  //     stayTurn();\n  //     updateScore((\"b-\"+n+\"-\"+(m-1)));\n  //     updateScore((\"b-\"+n+\"-\"+m));\n  //     updateTotal();\n  //   }\n  //   else if(elMap.get(pos1)==\"clicked\" && elMap.get(pos2)== \"clicked\" && elMap.get(pos3)==\"clicked\"){\n  //     compBoxFlag = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //     setBoxMap(boxMap.set(\"b-\"+n+\"-\"+(m-1), boxColor));\n  //     stayTurn();\n  //     updateScore((\"b-\"+n+\"-\"+(m-1)));\n  //     updateTotal();\n  //   }\n  //   else if(elMap.get(pos4)== \"clicked\" && elMap.get(pos5)==\"clicked\" && elMap.get(pos6)== \"clicked\"){\n  //     compBoxFlag = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //     setBoxMap(boxMap.set((\"b-\"+n+\"-\"+m), boxColor));\n  //     stayTurn();\n  //     updateScore((\"b-\"+n+\"-\"+m));\n  //     updateTotal();\n  //   }\n  // }\n\n  // function compCheck1lineHorizontal(id, elRef){\n  //   console.log(id);\n  //   var id1, id2, id3, id4, id5, id6;\n  //   var pos1, pos2, pos3, pos4, pos5, pos6;\n  //   var n = parseInt(id.charAt(2)), m = parseInt(id.charAt(4));\n  //   id1=\"h-\"+(n-1)+\"-\"+m;\n  //   id2=\"h-\"+(n+1)+\"-\"+m;\n  //   id3=\"v-\"+(n-1)+\"-\"+m;\n  //   id4=\"v-\"+(n-1)+\"-\"+(m+1);\n  //   id5=\"v-\"+(n)+\"-\"+m;\n  //   id6=\"v-\"+(n)+\"-\"+(m+1);\n  //   pos1=calcPosition(id1);\n  //   pos2=calcPosition(id2);\n  //   pos3=calcPosition(id3);\n  //   pos4=calcPosition(id4);\n  //   pos5=calcPosition(id5);\n  //   pos6=calcPosition(id6);\n\n  //   if(elMap.get(pos1)==\"clicked\" && elMap.get(pos3)== \"clicked\"){\n  //     comp2line = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //   }\n  //   else if(elMap.get(pos1)==\"clicked\" && elMap.get(pos4)== \"clicked\"){\n  //     comp2line = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //   }\n  //   if(elMap.get(pos3)==\"clicked\" && elMap.get(pos4)== \"clicked\"){\n  //     comp2line = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //   }\n  //   else if(elMap.get(pos2)== \"clicked\" && elMap.get(pos5)==\"clicked\"){\n  //     comp2line = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //   }\n  //   else if(elMap.get(pos2)== \"clicked\" && elMap.get(pos6)==\"clicked\"){\n  //     comp2line = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //   }\n  //   else if(elMap.get(pos5)== \"clicked\" && elMap.get(pos6)==\"clicked\"){\n  //     comp2line = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //   }\n  // }\n\n  // function compCheck1lineVertical(id, elRef){\n  //   console.log(id);\n  //   var id1, id2, id3, id4, id5, id6;\n  //   var pos1, pos2, pos3, pos4, pos5, pos6;\n  //   var n = parseInt(id.charAt(2)), m = parseInt(id.charAt(4));\n  //   id1=\"h-\"+(n)+\"-\"+(m-1);\n  //   id2=\"v-\"+(n)+\"-\"+(m-1);\n  //   id3=\"h-\"+(n+1)+\"-\"+(m-1);\n  //   id4=\"h-\"+(n)+\"-\"+(m);\n  //   id5=\"v-\"+(n)+\"-\"+(m+1);\n  //   id6=\"h-\"+(n+1)+\"-\"+(m);\n  //   pos1=calcPosition(id1);\n  //   pos2=calcPosition(id2);\n  //   pos3=calcPosition(id3);\n  //   pos4=calcPosition(id4);\n  //   pos5=calcPosition(id5);\n  //   pos6=calcPosition(id6);\n\n  //   if(elMap.get(pos1)==\"clicked\" && elMap.get(pos2)== \"clicked\"){\n  //     comp2line = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //   }\n  //   else if(elMap.get(pos1)==\"clicked\" && elMap.get(pos3)== \"clicked\"){\n  //     comp2line = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //   }\n  //   if(elMap.get(pos2)==\"clicked\" && elMap.get(pos3)== \"clicked\"){\n  //     comp2line = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //   }\n  //   else if(elMap.get(pos4)== \"clicked\" && elMap.get(pos5)==\"clicked\"){\n  //     comp2line = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //   }\n  //   else if(elMap.get(pos4)== \"clicked\" && elMap.get(pos6)==\"clicked\"){\n  //     comp2line = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //   }\n  //   else if(elMap.get(pos5)== \"clicked\" && elMap.get(pos6)==\"clicked\"){\n  //     comp2line = true;\n  //     compTempPos = calcPosition(id);\n  //     elMap.set(compTempPos, \"clicked\");\n  //     elRef.current.style.backgroundColor = blue;\n  //   }\n  // }\n\n  // function compFunc(elRef){\n  //   console.log(\"computer's turn\");\n  //   console.log(elMap);\n  //   compBoxFlag = false;\n  //   var comp1line = false;\n  //   var comp0line = false;\n\n  //   if(compBoxFlag == false){\n  //     // check box completion\n  //     console.log(\"check box completion\")\n  //     for(var i=1; i<=props.gridSize+1; ++i){\n  //       for(var j=1; j<=props.gridSize; ++j){\n  //         var compTempId1 = \"h-\"+[i]+\"-\"+[j];\n  //         var compTempId2 = \"v-\"+[j]+\"-\"+[i];\n  //         while(compBoxFlag == false){\n  //           if(elMap.get(calcPosition(compTempId1))!=\"clicked\"){\n  //             compCheckVerticalBoxes(compTempId1, elRef);\n  //           }\n  //           if(elMap.get(calcPosition(compTempId2))!=\"clicked\"){\n  //             compCheckHorizontalBoxes(compTempId2, elRef);\n  //           }\n  //         }\n  //       }\n  //     }\n  //   }\n\n  //   if(compBoxFlag == false && comp1line == false && comp0line == false){\n  //     // check 0 line clicked\n  //     console.log(\"check 0 line clicked\")\n  //     for(var i=1; i<=props.gridSize+1; ++i){\n  //       for(var j=1; j<=props.gridSize; ++j){\n  //         var compTempId1 = \"h-\"+[i]+\"-\"+[j];\n  //         var compTempId2 = \"v-\"+[j]+\"-\"+[i];\n  //         while(comp0line == false){\n  //           if(elMap.get(calcPosition(compTempId1))!=\"clicked\"){\n  //             comp0line = true;\n  //             compTempPos = calcPosition(compTempId1);\n  //             elMap.set(compTempPos, \"clicked\");\n  //             elRef.current.style.backgroundColor = blue;\n  //           }\n  //           if(elMap.get(calcPosition(compTempId2))!=\"clicked\"){\n  //             comp0line = true;\n  //             compTempPos = calcPosition(compTempId2);\n  //             elMap.set(compTempPos, \"clicked\");\n  //             elRef.current.style.backgroundColor = blue;\n  //           }\n  //         }  \n  //       }\n  //     }\n  //   }\n  // }\n  \n  const playerColorToastId = useRef(null);\n  useEffect(() => {\n    var curUrl = JSON.stringify(window.location.href);\n    var tempVsComp;\n    if(curUrl.substring(curUrl.length-8, curUrl.length-1)==\"offline\"){\n      tempVsComp = true;\n    }\n    if(!tempVsComp && !gameOver){\n      var playerColor = assignedColor==\"#c5183b\"?\"Red\":\"Blue\";\n      playerColorToastId.current = toast(\"You are \"+playerColor, {\n        position: \"top-right\",\n        autoClose: 5000,\n        hideProgressBar: true,\n        closeOnClick: true,\n        pauseOnHover: false,\n        draggable: true,\n        progress: undefined,\n      });  \n    }\n  }, [gameOver, props.vsComp, ]);\n\n  function notTurnFunc(){\n    toast(\"It's not your turn\", {\n      position: \"top-right\",\n      autoClose: 1000,\n      hideProgressBar: true,\n      closeOnClick: true,\n      pauseOnHover: false,\n      draggable: true,\n      progress: undefined,\n    }); \n  }\n\n  function sendMessage(tempMessage, playerRole){\n    if(tempMessage==\"\"){\n        return;\n    }\n    socket.emit(\"send-message\", {roomId: finalRoomId, tempMessage: tempMessage, playerRole: playerRole});\n  }\n\n  socket.off(\"receive-message\");\n  socket.on(\"receive-message\", (tempMessage, playerRole)=>{\n      console.log(\"message received\");\n\n      const tempMessageArr = [...messageArr];\n      tempMessageArr.push({sender: playerRole, message: tempMessage});\n      console.log(tempMessageArr);\n      setMessageArr(tempMessageArr);\n    })\n\n    useEffect(()=>{\n      // if(playerColorToastId.current!=null && showChat){\n      //   toast.dismiss(playerColorToastId.current);\n      // }\n      if(showChat){\n        setLastSeen(messageArr.length);\n        setUnreadCount(0);\n      }\n      var tempUnreadCount = messageArr.length-lastSeen;\n      setUnreadCount(tempUnreadCount);\n    }, [showChat])\n\n    useEffect(()=>{\n      if(showChat){\n        setUnreadCount(0);\n        setLastSeen(messageArr.length);\n      }\n      else{\n        var tempUnreadCount = messageArr.length-lastSeen;\n        setUnreadCount(tempUnreadCount);\n      }\n    }, [messageArr.length])\n\n    useEffect(() => {\n      if(showChat){\n        function handleClickOutside(event) {\n          if (chatRef.current && !chatRef.current.contains(event.target) && gridRef.current && !gridRef.current.contains(event.target) && chatButtonRef.current && !chatButtonRef.current.contains(event.target)) {\n            setShowChat(false);\n          }\n        }\n        document.addEventListener(\"mousedown\", handleClickOutside);\n        return () => {\n          document.removeEventListener(\"mousedown\", handleClickOutside);\n        };\n      }\n    }, [showChat]);\n\n    // socket.off(\"game-left\");\n    useEffect(()=>{\n      if(!props.vsComp){\n        !gameOver && socket.on(\"game-left\", ({winner})=>{\n          console.log(\"The other player left the game\");\n          setPlayerLeft(true);\n          setGameOver(true);\n          setGameLeaveWinner(winner);\n        })\n      }\n    }, [socket])\n\n    useEffect(()=>{\n      if(!props.vsComp){\n        var tempRoomId = finalRoomId;\n        if(!playerLeft){\n          const intervalId = setInterval(() => {\n            socket.emit(\"game-leave-check\", ({playerRole: props.playerRole, roomId: tempRoomId}))\n          }, 2000);\n        }\n      }\n    }, [finalRoomId])\n\n    window.addEventListener('popstate', (event) => {\n      if (event.state) {\n        window.location.reload();\n      }\n     }, false)\n\n    useEffect(()=>{\n      window.history.pushState({name: \"browserBack\"}, \"on browser back click\", window.location.href);\n      window.history.pushState({name: \"browserBack\"}, \"on browser back click\", window.location.href);\n    }, []);\n\n  return (\n    <>\n      <Header gridSize={props.gridSize} gameOver={gameOver} fromMidGame={true} vsComp={props.vsComp}/>\n      <div className=\"center-container\">\n        <div className={!gameOver?\"show-grid\":\"hide-grid\"} ref={gridRef}>\n          <Grid \n            gridSize={props.gridSize}\n            func={elementCheck}  \n            turn={turn} \n            map={elMap} \n            boxMap={boxMap} \n            vsComp={props.vsComp} \n            tempColor={tempColor}\n            tempId={tempId}\n            assignedColor={assignedColor}\n            notTurnFunc = {notTurnFunc}\n          />\n        </div>\n\n        <div className={!gameOver?\"hide-game-over\":\"show-game-over\"}>\n          <GameOver gameLeaveWinner={gameLeaveWinner} redScore={redScore} blueScore={blueScore} gridSize={props.gridSize} boxMap={boxMap} vsComp={props.vsComp} gameOver={gameOver}/>\n        </div>\n        {/* {console.log(turn)} */}\n        <div className={!gameOver?\"score-container\":\"hide-score-container\"}>\n          <h2 className=\"score\" id={turn==red?\"turn-score-red\":\"score-red\"}>Red: {redScore}</h2>\n          <h2 className=\"score\" id={turn==blue?\"turn-score-blue\":\"score-blue\"}>Blue: {blueScore}</h2>\n        </div>\n      </div>\n    {!props.vsComp&&<div className={assignedColor==red?\"chat-button-container-red\":\"chat-button-container-blue\"}>\n      <div ref={chatButtonRef} className=\"chat-button\" onClick={()=>{\n        setShowChat(!showChat);\n      }\n      }>\n        <div className=\"unread-count-container\" style={{visibility: unreadCount==0?\"hidden\":\"visible\"}}>\n          {unreadCount}\n        </div>\n      </div>\n    </div>}\n    {!props.vsComp&&\n      <div ref={chatRef}>\n        <Chat sendMessage={sendMessage} messageArr={messageArr} chatColor={assignedColor} roomId={finalRoomId} playerRole={props.playerRole} showChat={showChat}/>\n      </div>\n    }\n    <ToastContainer />\n    </>\n  );\n}"]},"metadata":{},"sourceType":"module"}